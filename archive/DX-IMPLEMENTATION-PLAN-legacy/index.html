<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The purity test for AI — Zero-flake CI for AI agents"><meta name=author content="Assay Team"><link href=https://docs.assay.dev/archive/DX-IMPLEMENTATION-PLAN-legacy/ rel=canonical><link rel=icon href=../../assets/logo.svg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.28"><title>DX Implementation Plan — Default Gate Readiness - Assay</title><link rel=stylesheet href=../../assets/stylesheets/main.6543a935.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-XXXXXXXXXX",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=deep-purple data-md-color-accent=green> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#dx-implementation-plan-default-gate-readiness class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Assay class="md-header__button md-logo" aria-label=Assay data-md-component=logo> <img src=../../assets/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Assay </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> DX Implementation Plan — Default Gate Readiness </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=deep-purple data-md-color-accent=green aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=deep-purple data-md-color-accent=green aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/Rul1an/assay title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> Rul1an/assay </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../getting-started/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../concepts/ class=md-tabs__link> Core Concepts </a> </li> <li class=md-tabs__item> <a href=../../python-sdk/ class=md-tabs__link> Python SDK </a> </li> <li class=md-tabs__item> <a href=../../mcp/ class=md-tabs__link> MCP Integration </a> </li> <li class=md-tabs__item> <a href=../../reference/config/ class=md-tabs__link> Configuration </a> </li> <li class=md-tabs__item> <a href=../../reference/cli/ class=md-tabs__link> CLI Reference </a> </li> <li class=md-tabs__item> <a href=../../metrics/ class=md-tabs__link> Metrics Reference </a> </li> <li class=md-tabs__item> <a href=../../use-cases/ class=md-tabs__link> Use Cases </a> </li> <li class=md-tabs__item> <a href=../../guides/ class=md-tabs__link> Guides </a> </li> <li class=md-tabs__item> <a href=../../architecture/ class=md-tabs__link> Architecture </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Contributing </a> </li> <li class=md-tabs__item> <a href=../../guides/troubleshooting/ class=md-tabs__link> Troubleshooting </a> </li> <li class=md-tabs__item> <a href=../../changelog/ class=md-tabs__link> Changelog </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Assay class="md-nav__button md-logo" aria-label=Assay data-md-component=logo> <img src=../../assets/logo.svg alt=logo> </a> Assay </label> <div class=md-nav__source> <a href=https://github.com/Rul1an/assay title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> Rul1an/assay </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quickstart/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/first-test/ class=md-nav__link> <span class=md-ellipsis> Your First Test </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/ci-integration/ class=md-nav__link> <span class=md-ellipsis> CI Integration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Core Concepts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Core Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../concepts/ class=md-nav__link> <span class=md-ellipsis> Core Concepts </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/traces/ class=md-nav__link> <span class=md-ellipsis> Traces </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/policies/ class=md-nav__link> <span class=md-ellipsis> Policies </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/metrics/ class=md-nav__link> <span class=md-ellipsis> Metrics </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/replay/ class=md-nav__link> <span class=md-ellipsis> Replay Engine </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/cache/ class=md-nav__link> <span class=md-ellipsis> Cache & Fingerprints </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/scope/ class=md-nav__link> <span class=md-ellipsis> Scope & Boundaries </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/fail-safe/ class=md-nav__link> <span class=md-ellipsis> Fail-Safe Config </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/pack-registry/ class=md-nav__link> <span class=md-ellipsis> Pack Registry </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Python SDK </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Python SDK </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../python-sdk/ class=md-nav__link> <span class=md-ellipsis> Python SDK </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> MCP Integration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> MCP Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../mcp/ class=md-nav__link> <span class=md-ellipsis> MCP Integration </span> </a> </li> <li class=md-nav__item> <a href=../../mcp/quickstart/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../mcp/import-formats/ class=md-nav__link> <span class=md-ellipsis> Import Formats </span> </a> </li> <li class=md-nav__item> <a href=../../mcp/server/ class=md-nav__link> <span class=md-ellipsis> Assay MCP Server </span> </a> </li> <li class=md-nav__item> <a href=../../mcp/self-correction/ class=md-nav__link> <span class=md-ellipsis> Self-Correcting Agents </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Configuration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Configuration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/config/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../reference/config/eval-yaml/ class=md-nav__link> <span class=md-ellipsis> mcp-eval.yaml </span> </a> </li> <li class=md-nav__item> <a href=../../reference/config/policies/ class=md-nav__link> <span class=md-ellipsis> Policy Files </span> </a> </li> <li class=md-nav__item> <a href=../../reference/sandbox-policies/ class=md-nav__link> <span class=md-ellipsis> Sandbox Policies </span> </a> </li> <li class=md-nav__item> <a href=../../reference/sandbox-env/ class=md-nav__link> <span class=md-ellipsis> Environment Filtering </span> </a> </li> <li class=md-nav__item> <a href=../../reference/config/sequences/ class=md-nav__link> <span class=md-ellipsis> Sequence Rules DSL </span> </a> </li> <li class=md-nav__item> <a href=../../reference/config/migration/ class=md-nav__link> <span class=md-ellipsis> Migration Guide </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> CLI Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> CLI Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/cli/ class=md-nav__link> <span class=md-ellipsis> CLI Reference </span> </a> </li> <li class=md-nav__item> <a href=../../reference/cli/init/ class=md-nav__link> <span class=md-ellipsis> assay init </span> </a> </li> <li class=md-nav__item> <a href=../../reference/cli/validate/ class=md-nav__link> <span class=md-ellipsis> assay validate </span> </a> </li> <li class=md-nav__item> <a href=../../reference/cli/run/ class=md-nav__link> <span class=md-ellipsis> assay run </span> </a> </li> <li class=md-nav__item> <a href=../../reference/cli/generate/ class=md-nav__link> <span class=md-ellipsis> assay generate </span> </a> </li> <li class=md-nav__item> <a href=../../reference/cli/explain/ class=md-nav__link> <span class=md-ellipsis> assay explain </span> </a> </li> <li class=md-nav__item> <a href=../../reference/cli/doctor/ class=md-nav__link> <span class=md-ellipsis> assay doctor </span> </a> </li> <li class=md-nav__item> <a href=../../reference/cli/watch/ class=md-nav__link> <span class=md-ellipsis> assay watch </span> </a> </li> <li class=md-nav__item> <a href=../../reference/cli/sandbox/ class=md-nav__link> <span class=md-ellipsis> assay sandbox </span> </a> </li> <li class=md-nav__item> <a href=../../reference/cli/import/ class=md-nav__link> <span class=md-ellipsis> assay import </span> </a> </li> <li class=md-nav__item> <a href=../../reference/cli/migrate/ class=md-nav__link> <span class=md-ellipsis> assay migrate </span> </a> </li> <li class=md-nav__item> <a href=../../reference/cli/replay/ class=md-nav__link> <span class=md-ellipsis> assay replay </span> </a> </li> <li class=md-nav__item> <a href=../../reference/cli/mcp-server/ class=md-nav__link> <span class=md-ellipsis> assay mcp-server </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Metrics Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Metrics Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../metrics/ class=md-nav__link> <span class=md-ellipsis> Assertion Types (V1) </span> </a> </li> <li class=md-nav__item> <a href=../../metrics/args-valid/ class=md-nav__link> <span class=md-ellipsis> args_valid </span> </a> </li> <li class=md-nav__item> <a href=../../metrics/sequence-valid/ class=md-nav__link> <span class=md-ellipsis> sequence_valid </span> </a> </li> <li class=md-nav__item> <a href=../../metrics/tool-blocklist/ class=md-nav__link> <span class=md-ellipsis> tool_blocklist </span> </a> </li> <li class=md-nav__item> <a href=../../metrics/custom/ class=md-nav__link> <span class=md-ellipsis> Custom Metrics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Use Cases </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Use Cases </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../use-cases/ class=md-nav__link> <span class=md-ellipsis> Use Cases </span> </a> </li> <li class=md-nav__item> <a href=../../use-cases/ci-gate/ class=md-nav__link> <span class=md-ellipsis> CI Regression Gate </span> </a> </li> <li class=md-nav__item> <a href=../../use-cases/debugging/ class=md-nav__link> <span class=md-ellipsis> Trace-Driven Debugging </span> </a> </li> <li class=md-nav__item> <a href=../../use-cases/air-gapped/ class=md-nav__link> <span class=md-ellipsis> Air-Gapped Enterprise </span> </a> </li> <li class=md-nav__item> <a href=../../use-cases/self-correction/ class=md-nav__link> <span class=md-ellipsis> Agent Self-Correction </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_10> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex=0> <span class=md-ellipsis> Guides </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=false> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../guides/ class=md-nav__link> <span class=md-ellipsis> Guides </span> </a> </li> <li class=md-nav__item> <a href=../../guides/sandbox-security/ class=md-nav__link> <span class=md-ellipsis> Sandbox Security </span> </a> </li> <li class=md-nav__item> <a href=../../guides/gateway-pattern/ class=md-nav__link> <span class=md-ellipsis> Gateway Pattern </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_11> <label class=md-nav__link for=__nav_11 id=__nav_11_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_11_label aria-expanded=false> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/crates/ class=md-nav__link> <span class=md-ellipsis> Crate Structure </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/data-flow/ class=md-nav__link> <span class=md-ellipsis> Data Flow </span> </a> </li> <li class=md-nav__item> <a href=../../PERFORMANCE-BUDGETS/ class=md-nav__link> <span class=md-ellipsis> Performance Budgets </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/adrs/ class=md-nav__link> <span class=md-ellipsis> ADRs </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_12> <label class=md-nav__link for=__nav_12 id=__nav_12_label tabindex=0> <span class=md-ellipsis> Contributing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_12_label aria-expanded=false> <label class=md-nav__title for=__nav_12> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/setup/ class=md-nav__link> <span class=md-ellipsis> Development Setup </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/metrics/ class=md-nav__link> <span class=md-ellipsis> Adding Metrics </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/releases/ class=md-nav__link> <span class=md-ellipsis> Release Process </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../guides/troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> <li class=md-nav__item> <a href=../../changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#rfc-001-execution-track class=md-nav__link> <span class=md-ellipsis> RFC-001 Execution Track </span> </a> </li> <li class=md-nav__item> <a href=#p0p1-epic-execution-summary class=md-nav__link> <span class=md-ellipsis> P0/P1 Epic Execution Summary </span> </a> </li> <li class=md-nav__item> <a href=#no-regression-gates-permanent class=md-nav__link> <span class=md-ellipsis> No-Regression Gates (Permanent) </span> </a> </li> <li class=md-nav__item> <a href=#p1-dx-contract-surfaces class=md-nav__link> <span class=md-ellipsis> P1 DX Contract Surfaces </span> </a> <nav class=md-nav aria-label="P1 DX Contract Surfaces"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ep1-1-action-v21-compliance-pack-first class=md-nav__link> <span class=md-ellipsis> EP1-1 Action v2.1 (compliance-pack first) </span> </a> </li> <li class=md-nav__item> <a href=#ep1-2-golden-path-30m-first-signal class=md-nav__link> <span class=md-ellipsis> EP1-2 Golden Path (&lt;30m first signal) </span> </a> </li> <li class=md-nav__item> <a href=#ep1-3-explain-compliance-hints-in-review class=md-nav__link> <span class=md-ellipsis> EP1-3 Explain + Compliance Hints (in review) </span> </a> </li> <li class=md-nav__item> <a href=#ep1-4-drift-visibility-generate-diff-in-review class=md-nav__link> <span class=md-ellipsis> EP1-4 Drift Visibility (generate --diff) (in review) </span> </a> </li> <li class=md-nav__item> <a href=#ep1-5-watch-hardening-existing-command-hardening-only class=md-nav__link> <span class=md-ellipsis> EP1-5 Watch hardening (existing command, hardening only) </span> </a> </li> <li class=md-nav__item> <a href=#ep1-6-privacy-safe-observability-defaults class=md-nav__link> <span class=md-ellipsis> EP1-6 Privacy-safe observability defaults </span> </a> </li> <li class=md-nav__item> <a href=#ep1-7-mcp-auth-hardening-e6a class=md-nav__link> <span class=md-ellipsis> EP1-7 MCP auth hardening (E6a) </span> </a> </li> <li class=md-nav__item> <a href=#ep1-8-replay-bundle-hardening class=md-nav__link> <span class=md-ellipsis> EP1-8 Replay bundle hardening </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#progress-update-2026-02-08 class=md-nav__link> <span class=md-ellipsis> Progress Update (2026-02-08) </span> </a> <nav class=md-nav aria-label="Progress Update (2026-02-08)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#wave-c-execution-blueprint-sota-2026 class=md-nav__link> <span class=md-ellipsis> Wave C Execution Blueprint (SOTA 2026) </span> </a> <nav class=md-nav aria-label="Wave C Execution Blueprint (SOTA 2026)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#c0-first-metrics-and-gates-required class=md-nav__link> <span class=md-ellipsis> C0 first: metrics and gates (required) </span> </a> </li> <li class=md-nav__item> <a href=#c1-c4-trigger-table class=md-nav__link> <span class=md-ellipsis> C1-C4 trigger table </span> </a> </li> <li class=md-nav__item> <a href=#wave-c-hard-stop-lines class=md-nav__link> <span class=md-ellipsis> Wave C hard stop-lines </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#post-191-follow-up-plan class=md-nav__link> <span class=md-ellipsis> Post-#191 Follow-up Plan </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dx-north-star-2026 class=md-nav__link> <span class=md-ellipsis> DX North Star (2026) </span> </a> <nav class=md-nav aria-label="DX North Star (2026)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#execution-filters class=md-nav__link> <span class=md-ellipsis> Execution Filters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#default-gate-gono-go-checklist-p0 class=md-nav__link> <span class=md-ellipsis> Default Gate Go/No-Go Checklist (P0) </span> </a> </li> <li class=md-nav__item> <a href=#0-epics-overview class=md-nav__link> <span class=md-ellipsis> 0. Epics Overview </span> </a> <nav class=md-nav aria-label="0. Epics Overview"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#epic-e1-blessed-init-ci-on-ramp class=md-nav__link> <span class=md-ellipsis> Epic E1: Blessed init &amp; CI on-ramp </span> </a> </li> <li class=md-nav__item> <a href=#epic-e2-pr-feedback-ux-junit-sarif-fork class=md-nav__link> <span class=md-ellipsis> Epic E2: PR feedback UX (JUnit, SARIF, fork) </span> </a> </li> <li class=md-nav__item> <a href=#epic-e3-exit-codes-reason-code-registry class=md-nav__link> <span class=md-ellipsis> Epic E3: Exit codes &amp; reason code registry </span> </a> </li> <li class=md-nav__item> <a href=#epic-e4-ergonomie-debuggability class=md-nav__link> <span class=md-ellipsis> Epic E4: Ergonomie &amp; debuggability </span> </a> </li> <li class=md-nav__item> <a href=#epic-e5-observability-privacy-defaults class=md-nav__link> <span class=md-ellipsis> Epic E5: Observability &amp; privacy defaults </span> </a> </li> <li class=md-nav__item> <a href=#epic-e6-p13-mcp-auth-hardening-security-baseline class=md-nav__link> <span class=md-ellipsis> Epic E6: P1.3 MCP Auth Hardening (Security baseline) </span> </a> </li> <li class=md-nav__item> <a href=#epic-e7-p11-judge-reliability-mvp class=md-nav__link> <span class=md-ellipsis> Epic E7: P1.1 Judge Reliability MVP </span> </a> </li> <li class=md-nav__item> <a href=#epic-e8-p12-otel-genai-observability class=md-nav__link> <span class=md-ellipsis> Epic E8: P1.2 OTel GenAI (Observability) </span> </a> </li> <li class=md-nav__item> <a href=#epic-e9-replay-bundle-dx-forensic class=md-nav__link> <span class=md-ellipsis> Epic E9: Replay Bundle (DX + forensic) </span> </a> </li> <li class=md-nav__item> <a href=#epics-volgorde-afhankelijkheden class=md-nav__link> <span class=md-ellipsis> Epics: volgorde &amp; afhankelijkheden </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#1-first-15-minutes-init-as-blessed-on-ramp class=md-nav__link> <span class=md-ellipsis> 1. First 15 minutes: init as blessed on-ramp </span> </a> <nav class=md-nav aria-label="1. First 15 minutes: init as blessed on-ramp"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#11-template-drift-v1-v2-action-in-init-ci class=md-nav__link> <span class=md-ellipsis> 1.1 Template drift (v1 → v2 action in init --ci) </span> </a> </li> <li class=md-nav__item> <a href=#12-one-blessed-entrypoint-init-ci-vs-init-ci class=md-nav__link> <span class=md-ellipsis> 1.2 One blessed entrypoint: init --ci vs init-ci </span> </a> </li> <li class=md-nav__item> <a href=#13-one-click-dx-demo-repos-p1 class=md-nav__link> <span class=md-ellipsis> 1.3 One-click DX demo repos (P1) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-pr-feedback-ux class=md-nav__link> <span class=md-ellipsis> 2. PR feedback UX </span> </a> <nav class=md-nav aria-label="2. PR feedback UX"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-junit-default-native-annotations-blessed-snippet class=md-nav__link> <span class=md-ellipsis> 2.1 JUnit: default + native annotations (blessed snippet) </span> </a> </li> <li class=md-nav__item> <a href=#22-sarif-always-one-location-upload-contract-limits-p0p1 class=md-nav__link> <span class=md-ellipsis> 2.2 SARIF: always one location + upload contract + limits (P0/P1) </span> </a> </li> <li class=md-nav__item> <a href=#23-fork-pr-no-sarifcomment-fallback-to-job-summary-p1 class=md-nav__link> <span class=md-ellipsis> 2.3 Fork PR: no SARIF/comment; fallback to job summary (P1) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-exit-codes-remove-dx-landmine-p0 class=md-nav__link> <span class=md-ellipsis> 3. Exit codes: remove DX landmine (P0) </span> </a> </li> <li class=md-nav__item> <a href=#4-ergonomie-debuggability class=md-nav__link> <span class=md-ellipsis> 4. Ergonomie &amp; debuggability </span> </a> <nav class=md-nav aria-label="4. Ergonomie & debuggability"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#41-default-next-step-in-every-error-p1 class=md-nav__link> <span class=md-ellipsis> 4.1 Default "next step" in every error (P1) </span> </a> </li> <li class=md-nav__item> <a href=#42-performance-dx-slowest-5-cache-hit-rate-phase-timings-p1 class=md-nav__link> <span class=md-ellipsis> 4.2 Performance-DX: slowest 5, cache hit rate, phase timings (P1) </span> </a> </li> <li class=md-nav__item> <a href=#43-progress-ux-nm-tests-eta-ish-p1 class=md-nav__link> <span class=md-ellipsis> 4.3 Progress UX: N/M tests, ETA-ish (P1) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5-observability-privacy-safe-defaults-p1 class=md-nav__link> <span class=md-ellipsis> 5. Observability: privacy-safe defaults (P1) </span> </a> </li> <li class=md-nav__item> <a href=#6-backlog-summary-copy-paste-for-issues class=md-nav__link> <span class=md-ellipsis> 6. Backlog summary (copy-paste for issues) </span> </a> <nav class=md-nav aria-label="6. Backlog summary (copy-paste for issues)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#p0-must-have-before-default-gate class=md-nav__link> <span class=md-ellipsis> P0 (must-have before default gate) </span> </a> </li> <li class=md-nav__item> <a href=#p1-sota class=md-nav__link> <span class=md-ellipsis> P1 (SOTA) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#7-file-level-checklist-patchlist class=md-nav__link> <span class=md-ellipsis> 7. File-level checklist (patchlist) </span> </a> </li> <li class=md-nav__item> <a href=#8-p1-sota-implementation-judge-security-observability-replay class=md-nav__link> <span class=md-ellipsis> 8. P1 SOTA Implementation (Judge, Security, Observability, Replay) </span> </a> <nav class=md-nav aria-label="8. P1 SOTA Implementation (Judge, Security, Observability, Replay)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#81-p13-mcp-auth-hardening-security-baseline class=md-nav__link> <span class=md-ellipsis> 8.1 P1.3 MCP Auth Hardening (Security Baseline) </span> </a> <nav class=md-nav aria-label="8.1 P1.3 MCP Auth Hardening (Security Baseline)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#811-resource-indicators-rfc-8707 class=md-nav__link> <span class=md-ellipsis> 8.1.1 Resource Indicators (RFC 8707) </span> </a> </li> <li class=md-nav__item> <a href=#812-dpop-sender-constrained-tokens-optional-hardening class=md-nav__link> <span class=md-ellipsis> 8.1.2 DPoP (Sender-Constrained Tokens) — Optional Hardening </span> </a> </li> <li class=md-nav__item> <a href=#813-bleeding-edge-algtypcrit-hardening-jwt-footguns class=md-nav__link> <span class=md-ellipsis> 8.1.3 Bleeding Edge: Alg/Typ/Crit Hardening (JWT Footguns) </span> </a> </li> <li class=md-nav__item> <a href=#814-bleeding-edge-replay-defense-dpop class=md-nav__link> <span class=md-ellipsis> 8.1.4 Bleeding Edge: Replay Defense (DPoP) </span> </a> </li> <li class=md-nav__item> <a href=#815-bleeding-edge-jwks-caching-done-right class=md-nav__link> <span class=md-ellipsis> 8.1.5 Bleeding Edge: JWKS Caching "Done Right" </span> </a> </li> <li class=md-nav__item> <a href=#816-negative-test-suite class=md-nav__link> <span class=md-ellipsis> 8.1.6 Negative Test Suite </span> </a> </li> <li class=md-nav__item> <a href=#817-definition-of-done class=md-nav__link> <span class=md-ellipsis> 8.1.7 Definition of Done </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#82-p11-judge-reliability-mvp-ci-signalnoise class=md-nav__link> <span class=md-ellipsis> 8.2 P1.1 Judge Reliability MVP (CI Signal/Noise) </span> </a> <nav class=md-nav aria-label="8.2 P1.1 Judge Reliability MVP (CI Signal/Noise)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#821-borderline-band-adaptive-calibration class=md-nav__link> <span class=md-ellipsis> 8.2.1 Borderline Band + Adaptive Calibration </span> </a> </li> <li class=md-nav__item> <a href=#822-bleeding-edge-randomized-order-as-default class=md-nav__link> <span class=md-ellipsis> 8.2.2 Bleeding Edge: Randomized Order as DEFAULT </span> </a> </li> <li class=md-nav__item> <a href=#823-order-invariance-bias-mitigation class=md-nav__link> <span class=md-ellipsis> 8.2.3 Order-Invariance (Bias Mitigation) </span> </a> </li> <li class=md-nav__item> <a href=#824-bleeding-edge-rerun-on-instability-not-just-borderline class=md-nav__link> <span class=md-ellipsis> 8.2.4 Bleeding Edge: Rerun on Instability (Not Just Borderline) </span> </a> </li> <li class=md-nav__item> <a href=#825-rerun-strategy-2-of-3-majority class=md-nav__link> <span class=md-ellipsis> 8.2.5 Rerun Strategy (2-of-3 Majority) </span> </a> </li> <li class=md-nav__item> <a href=#826-output-metrics class=md-nav__link> <span class=md-ellipsis> 8.2.6 Output Metrics </span> </a> </li> <li class=md-nav__item> <a href=#827-bleeding-edge-config-first-policies-per-suite-type class=md-nav__link> <span class=md-ellipsis> 8.2.7 Bleeding Edge: Config-First Policies per Suite Type </span> </a> </li> <li class=md-nav__item> <a href=#828-fail-modes-split-uncertain-from-unavailable class=md-nav__link> <span class=md-ellipsis> 8.2.8 Fail Modes: Split "Uncertain" from "Unavailable" </span> </a> </li> <li class=md-nav__item> <a href=#829-future-multi-judge-support-placeholder class=md-nav__link> <span class=md-ellipsis> 8.2.9 Future: Multi-Judge Support (Placeholder) </span> </a> </li> <li class=md-nav__item> <a href=#8210-definition-of-done class=md-nav__link> <span class=md-ellipsis> 8.2.10 Definition of Done </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#83-p12-otel-genai-observability class=md-nav__link> <span class=md-ellipsis> 8.3 P1.2 OTel GenAI (Observability) </span> </a> <nav class=md-nav aria-label="8.3 P1.2 OTel GenAI (Observability)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#831-bleeding-edge-semconv-version-gating class=md-nav__link> <span class=md-ellipsis> 8.3.1 Bleeding Edge: Semconv Version Gating </span> </a> </li> <li class=md-nav__item> <a href=#832-span-layers class=md-nav__link> <span class=md-ellipsis> 8.3.2 Span Layers </span> </a> </li> <li class=md-nav__item> <a href=#833-bleeding-edge-low-cardinality-enforcement-hard class=md-nav__link> <span class=md-ellipsis> 8.3.3 Bleeding Edge: Low-Cardinality Enforcement (Hard) </span> </a> </li> <li class=md-nav__item> <a href=#834-bleeding-edge-composable-redaction-policies class=md-nav__link> <span class=md-ellipsis> 8.3.4 Bleeding Edge: Composable Redaction Policies </span> </a> </li> <li class=md-nav__item> <a href=#835-definition-of-done class=md-nav__link> <span class=md-ellipsis> 8.3.5 Definition of Done </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#84-replay-bundle-dx-forensic class=md-nav__link> <span class=md-ellipsis> 8.4 Replay Bundle (DX + Forensic) </span> </a> <nav class=md-nav aria-label="8.4 Replay Bundle (DX + Forensic)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#841-bundle-format class=md-nav__link> <span class=md-ellipsis> 8.4.1 Bundle Format </span> </a> </li> <li class=md-nav__item> <a href=#842-bleeding-edge-toolchain-capture-critical-for-reproducibility class=md-nav__link> <span class=md-ellipsis> 8.4.2 Bleeding Edge: Toolchain Capture (Critical for Reproducibility) </span> </a> </li> <li class=md-nav__item> <a href=#843-bleeding-edge-deterministic-seed-logging class=md-nav__link> <span class=md-ellipsis> 8.4.3 Bleeding Edge: Deterministic Seed Logging </span> </a> </li> <li class=md-nav__item> <a href=#844-bleeding-edge-scrubbed-cassettes-policy class=md-nav__link> <span class=md-ellipsis> 8.4.4 Bleeding Edge: Scrubbed Cassettes Policy </span> </a> </li> <li class=md-nav__item> <a href=#845-privacy-minimal-secrets-risk class=md-nav__link> <span class=md-ellipsis> 8.4.5 Privacy: Minimal Secrets Risk </span> </a> </li> <li class=md-nav__item> <a href=#846-cli-interface class=md-nav__link> <span class=md-ellipsis> 8.4.6 CLI Interface </span> </a> </li> <li class=md-nav__item> <a href=#847-definition-of-done class=md-nav__link> <span class=md-ellipsis> 8.4.7 Definition of Done </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#85-p1-file-level-checklist-updated class=md-nav__link> <span class=md-ellipsis> 8.5 P1 File-Level Checklist (Updated) </span> </a> </li> <li class=md-nav__item> <a href=#86-p1-effort-summary class=md-nav__link> <span class=md-ellipsis> 8.6 P1 Effort Summary </span> </a> </li> <li class=md-nav__item> <a href=#87-pr-sequence-blueprint class=md-nav__link> <span class=md-ellipsis> 8.7 PR Sequence Blueprint </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#9-references class=md-nav__link> <span class=md-ellipsis> 9. References </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=dx-implementation-plan-default-gate-readiness>DX Implementation Plan — Default Gate Readiness<a class=headerlink href=#dx-implementation-plan-default-gate-readiness title="Permanent link">&para;</a></h1> <p><strong>Status:</strong> Living plan (updated after Wave A merge) <strong>Date:</strong> 2026-02-08 <strong>Source:</strong> Critical DX review of <a href=DX-REVIEW-MATERIALS.md>DX-REVIEW-MATERIALS.md</a>; aligns with <a href=architecture/ADR-019-PR-Gate-2026-SOTA.md>ADR-019 PR Gate 2026 SOTA</a> and <a href=ROADMAP.md>ROADMAP</a>. Aangepast na SOTA/DX reality check: technische correcties (GitHub Actions ref, SARIF limits, exit-codes compat), P0 Go/No-Go checklist, scope trims (E6a/E6b, cost guardrails, scrubbing deny-by-default). Score na aanpassingen: 9.7/10.</p> <p>This document turns the DX review into a concrete backlog with <strong>per-file patchlist</strong> and test cases. Work is ordered P0 (must-have before default gate) then P1 (SOTA).</p> <hr> <h2 id=rfc-001-execution-track>RFC-001 Execution Track<a class=headerlink href=#rfc-001-execution-track title="Permanent link">&para;</a></h2> <p>Canonical RFC for debt-ranked execution: - <a href=architecture/RFC-001-dx-ux-governance.md>RFC-001: DX/UX &amp; Governance</a></p> <p>PR order for the new track: 1. PR-A1: typed error boundary + centralized reason-code mapping (Wave A start). 2. PR-A2: remove strict-mode env mutation (<code>set_var</code>) in run/ci path. 3. PR-A3: canonical config writing hardening (<code>init</code>/templates + docs). 4. PR-B1/B2/B3: pipeline unification + coupling reduction + <code>--pack</code> to <code>--preset</code>. 5. PR-C*: perf/scale only when benchmark data justifies it.</p> <p>Current blocker gates (re-assessed on implemented code): - <strong>Wave A blocker</strong>: A1 must become truly typed at classification boundary (stable fields first, substring fallback explicit/legacy only). - <strong>Wave A blocker</strong>: A1 boundary errors need stable forensic fields (path/status/provider) to avoid message-only support triage. - <strong>Wave B blocker</strong>: B1 requires explicit run-vs-ci parity contract tests for exit/reason and output invariants. - <strong>P2 alerts (non-blocking)</strong>: replay coupling wording update, A2 scope clarity (run/ci vs CLI-wide), B3 deprecation timeline as governance.</p> <p>Current branch focus: - PR-A1 (merged to <code>main</code> via <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/198 title="GitHub Issue: Rul1an/assay #198">#198</a>): typed boundary mapping for run/ci hot-path triage with unit coverage. - PR-A2/A3 (merged to <code>main</code> via <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/202 title="GitHub Issue: Rul1an/assay #202">#202</a>): strict-mode env mutation removal + canonical init/template config writing. - PR-B1/B2/B3 (merged to <code>main</code> via <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/204 title="GitHub Issue: Rul1an/assay #204">#204</a>/<a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/205 title="GitHub Issue: Rul1an/assay #205">#205</a>/<a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/209 title="GitHub Issue: Rul1an/assay #209">#209</a>): pipeline unification + dispatch decoupling + <code>--preset</code> rename with compat aliases. - Wave C kickoff: - PR-C0 (<a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/212 title="GitHub Issue: Rul1an/assay #212">#212</a>, open): additive performance trigger metrics + Wave C trigger guardrails in RFC-001. - PR-C1 (<a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/213 title="GitHub Issue: Rul1an/assay #213">#213</a>, open): reproducible verify/lint perf harness + workload budgets (<code>docs/PERFORMANCE-BUDGETS.md</code>). - PR-C2 (<a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/214 title="GitHub Issue: Rul1an/assay #214">#214</a>, open): runner clone overhead measurement surfaced in summary performance metrics. - PR-C3 (current branch): profile-store harness + runtime load/merge/save telemetry and trigger warnings. - PR-C4 (next): bounded run-id digest tracking beyond short ring buffer + memory/eviction visibility.</p> <hr> <h2 id=p0p1-epic-execution-summary>P0/P1 Epic Execution Summary<a class=headerlink href=#p0p1-epic-execution-summary title="Permanent link">&para;</a></h2> <p>Compact execution view for all P0/P1 workstreams.</p> <table> <thead> <tr> <th>Epic</th> <th>Priority</th> <th>Status</th> <th>Outcome</th> </tr> </thead> <tbody> <tr> <td>EP0-1 Blessed Init + CI Template Contract</td> <td>P0</td> <td>Done</td> <td><code>assay init --ci</code> paved road + workflow contract</td> </tr> <tr> <td>EP0-2 CI Feedback Contracts (JUnit/SARIF/report I/O)</td> <td>P0</td> <td>Done</td> <td>stable CI outputs, robust reporting behavior</td> </tr> <tr> <td>EP0-3 Exit/Reason Contract</td> <td>P0</td> <td>Done</td> <td>deterministic exit/reason surfaces for automation</td> </tr> <tr> <td>EP1-1 GitHub Action v2.1 (compliance-pack first)</td> <td>P1</td> <td>Planned (Next)</td> <td>Action v2.1 P1 slice on existing PR/CI surfaces</td> </tr> <tr> <td>EP1-2 Golden Path (&lt;30m first signal)</td> <td>P1</td> <td>Planned</td> <td>init bootstrap: hello-trace + smoke suite</td> </tr> <tr> <td>EP1-3 Explain + Compliance Hints</td> <td>P1</td> <td>In review</td> <td>feature delivered; parity/contract hardening pending</td> </tr> <tr> <td>EP1-4 Drift Visibility (<code>generate --diff</code>)</td> <td>P1</td> <td>In review</td> <td>feature delivered; parity/contract hardening pending</td> </tr> <tr> <td>EP1-5 Watch Determinism Hardening</td> <td>P1</td> <td>Planned (Hardening-only)</td> <td>existing watch behavior hardened for determinism/edge cases</td> </tr> <tr> <td>EP1-6 Privacy-safe Observability Defaults</td> <td>P1</td> <td>Planned</td> <td>redaction/cardinality defaults and tests</td> </tr> <tr> <td>EP1-7 MCP Auth Hardening (E6a hard scope)</td> <td>P1</td> <td>Planned</td> <td>OAuth/JWT/JWKS no-pass-through baseline</td> </tr> <tr> <td>EP1-8 Replay Bundle Hardening</td> <td>P1</td> <td>Planned</td> <td>reproducible evidence bundle + manifest discipline</td> </tr> </tbody> </table> <p>Recommended sequence: 1. EP1-1 GitHub Action v2.1 (compliance-pack support). 2. EP1-2 Golden Path (&lt;30m first signal). 3. EP1-3 + EP1-4 parity hardening (docs/examples/contract tests; no feature expansion). 4. EP1-5 Watch hardening (determinism + Windows/file edge cases + loop tests). 5. EP1-6/EP1-7/EP1-8 parallel where capacity allows.</p> <p>Explicit deferred boundaries: - no native notify watcher backend now; - no full-repo docs link checker as hard CI gate; - no non-Unix atomic-write parity expansion in this slice; - no dedicated IDE governance control-plane in this phase.</p> <h2 id=no-regression-gates-permanent>No-Regression Gates (Permanent)<a class=headerlink href=#no-regression-gates-permanent title="Permanent link">&para;</a></h2> <p>Gate A (contract stability): - <code>run.json</code> / <code>summary.json</code> contracts, SARIF/JUnit outputs, and GitHub Action I/O remain backward-compatible by default.</p> <p>Gate B (onboarding velocity): - clean repo -&gt; first actionable Assay signal remains under 30 minutes on documented golden path.</p> <p>Any P1 epic that violates A or B must either: - include an explicit migration plan, or - be split so contract/onboarding stability lands first.</p> <h2 id=p1-dx-contract-surfaces>P1 DX Contract Surfaces<a class=headerlink href=#p1-dx-contract-surfaces title="Permanent link">&para;</a></h2> <p>Per epic we define what is normative (stable contract) versus best-effort (implementation detail).</p> <h3 id=ep1-1-action-v21-compliance-pack-first>EP1-1 Action v2.1 (compliance-pack first)<a class=headerlink href=#ep1-1-action-v21-compliance-pack-first title="Permanent link">&para;</a></h3> <ul> <li>Normative:</li> <li>compliance-pack resolution behavior and logged resolved pack reference.</li> <li>distinct failure modes: missing pack vs invalid pack vs lint/policy fail.</li> <li>output parity across Action surfaces (summary/SARIF/JUnit).</li> <li>Best effort:</li> <li>internal caching strategy for pack resolution.</li> <li>non-contractual log phrasing.</li> </ul> <h3 id=ep1-2-golden-path-30m-first-signal>EP1-2 Golden Path (&lt;30m first signal)<a class=headerlink href=#ep1-2-golden-path-30m-first-signal title="Permanent link">&para;</a></h3> <ul> <li>Normative:</li> <li>documented bootstrap flow must produce an actionable first signal.</li> <li>generated scaffold commands in docs must execute as written.</li> <li>regression gate enforces onboarding time budget.</li> <li>Best effort:</li> <li>exact sample fixture contents.</li> <li>cosmetic scaffold formatting.</li> </ul> <h3 id=ep1-3-explain-compliance-hints-in-review>EP1-3 Explain + Compliance Hints (in review)<a class=headerlink href=#ep1-3-explain-compliance-hints-in-review title="Permanent link">&para;</a></h3> <ul> <li>Normative:</li> <li><code>--compliance-pack</code> behavior and compatibility with non-pack mode.</li> <li>article hint + coverage summary field presence in supported output modes.</li> <li>failure output includes concrete next-action guidance.</li> <li>Best effort:</li> <li>wording of explanatory prose.</li> <li>ordering of non-contractual detail lines.</li> </ul> <h3 id=ep1-4-drift-visibility-generate-diff-in-review>EP1-4 Drift Visibility (<code>generate --diff</code>) (in review)<a class=headerlink href=#ep1-4-drift-visibility-generate-diff-in-review title="Permanent link">&para;</a></h3> <ul> <li>Normative:</li> <li>stable added/removed/changed semantics for drift output.</li> <li>deterministic diff output for identical inputs.</li> <li><code>--diff</code> does not alter existing write semantics without explicit write flags.</li> <li>Best effort:</li> <li>pretty-print formatting and grouping style.</li> <li>optional metadata lines.</li> </ul> <h3 id=ep1-5-watch-hardening-existing-command-hardening-only>EP1-5 Watch hardening (existing command, hardening only)<a class=headerlink href=#ep1-5-watch-hardening-existing-command-hardening-only title="Permanent link">&para;</a></h3> <ul> <li>Normative:</li> <li>debounce clamp range and trigger-coalescing behavior.</li> <li>watch-loop exit semantics (loop lifecycle vs run result logging).</li> <li>config parse failure fallback: keep watching at least config/trace/baseline.</li> <li>Best effort:</li> <li>polling interval tuning.</li> <li>filesystem timestamp granularity handling nuances.</li> </ul> <h3 id=ep1-6-privacy-safe-observability-defaults>EP1-6 Privacy-safe observability defaults<a class=headerlink href=#ep1-6-privacy-safe-observability-defaults title="Permanent link">&para;</a></h3> <ul> <li>Normative:</li> <li>safe-by-default redaction and cardinality guardrails are on by default.</li> <li>unsafe raw prompt/body exposure requires explicit opt-in configuration.</li> <li>default exports do not leak prompt/response bodies.</li> <li>Best effort:</li> <li>exact redaction text tokenization strategy.</li> <li>non-contractual telemetry attribute ordering.</li> </ul> <h3 id=ep1-7-mcp-auth-hardening-e6a>EP1-7 MCP auth hardening (E6a)<a class=headerlink href=#ep1-7-mcp-auth-hardening-e6a title="Permanent link">&para;</a></h3> <ul> <li>Normative:</li> <li>RFC 8707 resource/audience constraints enforced.</li> <li>JWT alg/typ/crit validation and JWKS rotation behavior enforced.</li> <li>no-pass-through token behavior enforced.</li> <li>Interop matrix (required):</li> <li>JWKS rotation / kid miss.</li> <li>alg confusion + typ/crit rejection.</li> <li>audience/resource mismatch handling.</li> <li>Best effort:</li> <li>cache refresh cadence internals.</li> <li>diagnostics verbosity.</li> </ul> <h3 id=ep1-8-replay-bundle-hardening>EP1-8 Replay bundle hardening<a class=headerlink href=#ep1-8-replay-bundle-hardening title="Permanent link">&para;</a></h3> <ul> <li>Normative:</li> <li>verify/scrub defaults are safe and on by default.</li> <li>bundle manifest captures deterministic replay-critical metadata.</li> <li>unsafe/raw capture paths require explicit opt-in.</li> <li>Best effort:</li> <li>archive layout details that do not affect verification/replay contract.</li> <li>optional manifest annotation fields.</li> </ul> <hr> <h2 id=progress-update-2026-02-08>Progress Update (2026-02-08)<a class=headerlink href=#progress-update-2026-02-08 title="Permanent link">&para;</a></h2> <p>Recent implementation state:</p> <ul> <li><strong>Wave A merged to <code>main</code>:</strong></li> <li><code>#198</code> (A1): centralized run/ci error classification via typed boundary helpers.</li> <li><code>#202</code> (A2/A3 integration): strict-mode env mutation removal + canonical scaffold/config writing.</li> <li><strong>Wave B merged to <code>main</code> (B1/B2):</strong></li> <li><code>#205</code>: shared pipeline + coupling reduction landing path.</li> <li><strong>Wave B3 in final integration:</strong></li> <li><code>#206</code> merged into <code>codex/rfc001-wave-b2-coupling</code>.</li> <li><code>#209</code> open (<code>codex/rfc001-wave-b2-coupling</code> -&gt; <code>main</code>) with auto-merge enabled.</li> <li><strong>P0/P1 DX slices merged earlier to <code>main</code>:</strong></li> <li>docs/CLI parity, <code>doctor --fix</code>, <code>watch</code> hardening, Action v2.1 pack contracts, and follow-up parity checks.</li> <li><strong>Deferred by design (unchanged):</strong></li> <li>native <code>notify</code> backend,</li> <li>full-repo docs link checks as hard gate,</li> <li>cross-platform atomic-write parity beyond Unix.</li> </ul> <p>Roadmap-aligned next execution order from here: 1. Land <code>#209</code> to complete Wave B3 on <code>main</code>. 2. Start <strong>Wave C0</strong> (perf control-plane instrumentation and CI baseline artifacts). 3. Execute C1-C4 only when C0 metrics cross trigger thresholds.</p> <p>Explicit "do not implement now" decisions: - Do not migrate to a native notify watcher yet (keep dependency-free polling in place). - Do not switch to full-repo docs link validation yet (keep changed-files guard). - Do not broaden doctor atomic-write guarantees beyond Unix in this slice. - Do not add a dedicated IDE governance control plane yet (focus on CLI/CI/PR surfaces first).</p> <h3 id=wave-c-execution-blueprint-sota-2026>Wave C Execution Blueprint (SOTA 2026)<a class=headerlink href=#wave-c-execution-blueprint-sota-2026 title="Permanent link">&para;</a></h3> <p>Wave C is optimization-only and must stay contract-safe.</p> <h4 id=c0-first-metrics-and-gates-required>C0 first: metrics and gates (required)<a class=headerlink href=#c0-first-metrics-and-gates-required title="Permanent link">&para;</a></h4> <p>Before C1-C4, add a stable perf signal surface:</p> <ul> <li><code>summary.json</code> perf fields:</li> <li><code>verify_ms</code>, <code>lint_ms</code>, <code>runner_clone_ms</code>, <code>profile_store_ms</code>, <code>run_id_memory_bytes</code>.</li> <li>CI artifact baseline (<code>bench-baseline.json</code>) for PR compare.</li> <li>PR perf gate classes:</li> <li>informational drift (non-blocking),</li> <li>threshold regression (blocking with explicit reason).</li> </ul> <h4 id=c1-c4-trigger-table>C1-C4 trigger table<a class=headerlink href=#c1-c4-trigger-table title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Slice</th> <th>Trigger</th> <th>Guardrail</th> </tr> </thead> <tbody> <tr> <td>C1 single-pass verify+lint</td> <td><code>verify_ms + lint_ms &gt; 5000</code> on representative corpus</td> <td>keep fail-closed verify semantics</td> </tr> <tr> <td>C2 RunnerRef ref-sharing</td> <td>clone overhead visible in profiles</td> <td>no behavior/contract drift</td> </tr> <tr> <td>C3 profile store batching</td> <td>&gt;10k entries or store phase dominates</td> <td>deterministic ordering + transactional writes</td> </tr> <tr> <td>C4 run-id scaling</td> <td>memory pressure/collision risk beyond ring buffer</td> <td>deterministic membership semantics</td> </tr> </tbody> </table> <h4 id=wave-c-hard-stop-lines>Wave C hard stop-lines<a class=headerlink href=#wave-c-hard-stop-lines title="Permanent link">&para;</a></h4> <ul> <li>No C-task without a referenced C0 measurement snapshot.</li> <li>No optimization that changes run/summary/SARIF/JUnit contract shape without versioning.</li> <li>No optimization that weakens determinism or evidence integrity guarantees.</li> </ul> <h3 id=post-191-follow-up-plan>Post-<a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/191 title="GitHub Issue: Rul1an/assay #191">#191</a> Follow-up Plan<a class=headerlink href=#post-191-follow-up-plan title="Permanent link">&para;</a></h3> <p>After integration PR <code>#191</code> lands in <code>main</code>, execution continues in three narrow follow-up slices to avoid scope creep:</p> <ol> <li><strong>PR A: init hello-trace colocation</strong></li> <li>Branch: <code>codex/p1-init-hello-trace-colocation</code></li> <li>Change: make <code>assay init --hello-trace</code> write <code>traces/hello.jsonl</code> relative to the directory of <code>--config</code>.</li> <li> <p>Acceptance:</p> <ul> <li><code>assay init --hello-trace --config /tmp/x/eval.yaml</code> creates <code>/tmp/x/traces/hello.jsonl</code>.</li> <li>Existing default flow remains unchanged for local <code>eval.yaml</code>.</li> </ul> </li> <li> <p><strong>PR B: doctor dry-run exit contract</strong></p> </li> <li>Branch: <code>codex/p1-doctor-dry-run-exit-contract</code></li> <li>Change: align <code>doctor --fix --dry-run</code> exit codes with documented diagnostics contract.</li> <li> <p>Acceptance:</p> <ul> <li>Dry-run still writes nothing.</li> <li>Exit code semantics are explicit and consistent across code, tests, and docs.</li> <li><code>doctor_fix_e2e</code> expectations match the final contract.</li> </ul> </li> <li> <p><strong>PR C: watch RunArgs drift reduction (optional)</strong></p> </li> <li>Branch: <code>codex/p1-watch-runargs-builder</code></li> <li>Change: reduce/manual <code>RunArgs</code> duplication in watch execution path to avoid default drift over time.</li> <li>Acceptance:<ul> <li>No behavior change in watch output/exit semantics.</li> <li>Refactor is covered by existing watch/run tests.</li> </ul> </li> </ol> <p>Delivery guardrails for all three follow-ups: - Keep slices independent and reviewable. - Do not change run/summary/action output contracts unless explicitly intended and documented. - Update <code>docs/DX-ROADMAP.md</code> status immediately after each merge.</p> <p>EU AI Act date anchors used in this plan: - 2025-02-02: first phased obligations active. - 2025-08-02: GPAI-focused obligations active. - 2026-08-02: broader obligations active.</p> <h2 id=dx-north-star-2026>DX North Star (2026)<a class=headerlink href=#dx-north-star-2026 title="Permanent link">&para;</a></h2> <p>Use this scorecard as a gate for roadmap choices. If a new item does not clearly improve at least one dimension below, it is de-prioritized.</p> <table> <thead> <tr> <th>Dimension</th> <th>Practical Target</th> <th>Current Baseline</th> <th>Planned Work</th> </tr> </thead> <tbody> <tr> <td>Time-to-first-signal</td> <td>First actionable result in &lt;30 min</td> <td>Good docs and commands, but no guaranteed hello-trace bootstrap</td> <td>Golden-path hardening in init/templates</td> </tr> <tr> <td>Quality-of-feedback</td> <td>Every failure routes to a next action</td> <td>Reason codes + doctor/explain exist</td> <td>Add explicit rerun/next-action hints in outputs and PR surfaces</td> </tr> <tr> <td>Workflow fit</td> <td>Native PR/CI/Security integration</td> <td>Action v2 + SARIF + PR comments already in place</td> <td>Action v2.1 compliance-pack support first</td> </tr> <tr> <td>Trust &amp; auditability</td> <td>Reproducible and shareable evidence</td> <td>Deterministic outputs and reason-code contracts exist</td> <td>Replay bundle hardening and stronger manifest usage</td> </tr> <tr> <td>Change resilience</td> <td>Drift visible before breakage</td> <td>Watch refresh and docs alignment are in place</td> <td><code>generate --diff</code> + drift-aware explain output</td> </tr> </tbody> </table> <h3 id=execution-filters>Execution Filters<a class=headerlink href=#execution-filters title="Permanent link">&para;</a></h3> <ul> <li>Prefer paved-road improvements over adding new interfaces.</li> <li>Keep policy gate decisions deterministic; keep reporting failures non-blocking where possible.</li> <li>Prioritize low-cognitive-load defaults (self-service templates over manual config work).</li> <li>Treat SARIF, run/summary JSON, and Action inputs/outputs as compatibility contracts.</li> </ul> <hr> <h2 id=default-gate-gono-go-checklist-p0>Default Gate Go/No-Go Checklist (P0)<a class=headerlink href=#default-gate-gono-go-checklist-p0 title="Permanent link">&para;</a></h2> <blockquote> <p><strong>Zodra alle items hieronder groen zijn: "default gate ready".</strong></p> </blockquote> <table> <thead> <tr> <th>#</th> <th>Criterium</th> <th>Test/Verificatie</th> <th>Status</th> </tr> </thead> <tbody> <tr> <td>1</td> <td><strong>init template uses v2 action</strong></td> <td><code>assay init --ci</code> → <code>.github/workflows/assay.yml</code> bevat exact <code>Rul1an/assay/assay-action@v2</code> (golden/contract test)</td> <td>✅</td> </tr> <tr> <td>2</td> <td><strong>SARIF always has locations</strong></td> <td>Unit test: elk SARIF result heeft <code>locations.length ≥ 1</code></td> <td>✅</td> </tr> <tr> <td>3</td> <td><strong>SARIF schema contract test</strong></td> <td>SARIF output passes schema 2.1.0 validation</td> <td>✅</td> </tr> <tr> <td>4</td> <td><strong>Exit codes aligned</strong></td> <td>Missing trace → exit 2 + <code>E_TRACE_NOT_FOUND</code>; judge unavail → exit 3 + <code>E_JUDGE_UNAVAILABLE</code></td> <td>✅</td> </tr> <tr> <td>5</td> <td><strong>reason_code everywhere</strong></td> <td>reason_code in: console, job summary, summary.json; <code>reason_code_version: 1</code> in summary.json</td> <td>✅</td> </tr> <tr> <td>6</td> <td><strong>summary.json stable</strong></td> <td><code>schema_version</code> + <code>reason_code_version</code> in output; golden test</td> <td>✅</td> </tr> <tr> <td>7</td> <td><strong>JUnit path contractual</strong></td> <td><code>.assay/reports/junit.xml</code> (of gekozen pad) in docs + tests + action</td> <td>✅</td> </tr> <tr> <td>8</td> <td><strong>Compat switch documented</strong></td> <td><code>--exit-codes=v2</code> (default) / <code>v1</code> (legacy) + <code>ASSAY_EXIT_CODES</code> env in run.md</td> <td>✅</td> </tr> </tbody> </table> <p><strong>Definition of "default gate ready":</strong> All ⬜ → ✅</p> <hr> <h2 id=0-epics-overview>0. Epics Overview<a class=headerlink href=#0-epics-overview title="Permanent link">&para;</a></h2> <p>De onderstaande epics groeperen het DX-plan in uitvoerbare eenheden. Per epic: <strong>goal</strong>, <strong>priority</strong> (P0/P1), <strong>stories</strong>, <strong>acceptance criteria</strong>, <strong>effort</strong>. De gedetailleerde patchlist staat in de secties 1–8.</p> <hr> <h3 id=epic-e1-blessed-init-ci-on-ramp>Epic E1: Blessed init &amp; CI on-ramp<a class=headerlink href=#epic-e1-blessed-init-ci-on-ramp title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td><strong>Goal</strong></td> <td>Eerste 15 minuten: één duidelijke, blessed flow van init tot CI; geen template drift.</td> </tr> <tr> <td><strong>Priority</strong></td> <td>P0 (1.1, 1.2), P1 (1.3)</td> </tr> <tr> <td><strong>Effort</strong></td> <td>P0: ~1 dag; P1: +1–2 dagen</td> </tr> </tbody> </table> <p><strong>Stories:</strong></p> <table> <thead> <tr> <th>ID</th> <th>Story</th> <th>Priority</th> <th>Detail ref</th> </tr> </thead> <tbody> <tr> <td>E1.1</td> <td>Template v2: <code>assay init --ci</code> genereert <code>.github/workflows/assay.yml</code> met <code>Rul1an/assay/assay-action@v2</code> (moving major tag) of exact tag/SHA; geen v1-referentie</td> <td>P0</td> <td>§1.1</td> </tr> <tr> <td>E1.2</td> <td>Blessed entrypoint: documenteer <code>assay init --ci</code> als blessed, <code>assay init-ci</code> als alias</td> <td>P0</td> <td>§1.2</td> </tr> <tr> <td>E1.3</td> <td>One-click DX demo repos: <code>examples/dx-demo-node</code>, <code>examples/dx-demo-python</code> (minimal app, workflow, baseline, README)</td> <td>P1</td> <td>§1.3</td> </tr> <tr> <td>E1.4</td> <td>Golden-path bootstrap: <code>assay init</code> genereert optioneel hello-trace fixture + smoke suite voor snelle first signal</td> <td>P1</td> <td>§1.2/§1.3</td> </tr> </tbody> </table> <p><strong>Acceptance criteria:</strong></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <code>assay init --ci</code> → <code>.github/workflows/assay.yml</code> bevat <code>assay-action@v2</code> (golden/contract test).</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Docs: init --ci = blessed; init-ci = alias; CI-integration + example repos link.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> (P1) CI of smoke: <code>assay run</code> in dx-demo-node en dx-demo-python slaagt.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> (P1) <code>assay init</code> kan een minimale trace + suite scaffolden die lokaal direct een bruikbaar signaal geeft.</li> </ul> <hr> <h3 id=epic-e2-pr-feedback-ux-junit-sarif-fork>Epic E2: PR feedback UX (JUnit, SARIF, fork)<a class=headerlink href=#epic-e2-pr-feedback-ux-junit-sarif-fork title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td><strong>Goal</strong></td> <td>PR-native feedback: JUnit-annotaties, SARIF upload die niet faalt, duidelijke grenzen bij fork PRs.</td> </tr> <tr> <td><strong>Priority</strong></td> <td>P0 (2.1 locatie + contract, 2.2), P1 (2.2 limits, 2.3 fork)</td> </tr> <tr> <td><strong>Effort</strong></td> <td>P0: ~1–2 dagen; P1: +0,5 dag</td> </tr> </tbody> </table> <p><strong>Stories:</strong></p> <table> <thead> <tr> <th>ID</th> <th>Story</th> <th>Priority</th> <th>Detail ref</th> </tr> </thead> <tbody> <tr> <td>E2.1</td> <td>JUnit default + blessed snippet: use <code>assay ci --junit ...</code>; run.md snippet "failures as annotations" + "where is junit.xml"</td> <td>P0</td> <td>§2.1</td> </tr> <tr> <td>E2.2</td> <td>SARIF location invariant: elk result ≥1 location (synthetic fallback); contract test (schema + upload-smoke)</td> <td>P0</td> <td>§2.2</td> </tr> <tr> <td>E2.3</td> <td>SARIF limits: truncate + "N results omitted" bij overschrijding GitHub-limits; configureerbaar</td> <td>P1</td> <td>§2.2</td> </tr> <tr> <td>E2.4</td> <td>Fork PR: documenteer "geen SARIF/comment, wel job summary"; action al conditioneel</td> <td>P1</td> <td>§2.3</td> </tr> </tbody> </table> <p><strong>Acceptance criteria:</strong></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> JUnit artifact + annotations bij failure met blessed snippet.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Unit: elk SARIF-result heeft <code>locations.length ≥ 1</code>; contract: schema 2.1.0 + upload-smoke.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> (P1) Truncatie + N omitted in run summary/SARIF description.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> (P1) Docs: fork = job summary only.</li> </ul> <hr> <h3 id=epic-e3-exit-codes-reason-code-registry>Epic E3: Exit codes &amp; reason code registry<a class=headerlink href=#epic-e3-exit-codes-reason-code-registry title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td><strong>Goal</strong></td> <td>Geen DX-landmine: exit 3 = infra/judge; trace not found = exit 2 + E_TRACE_NOT_FOUND; machine-readable reason codes overal.</td> </tr> <tr> <td><strong>Priority</strong></td> <td>P0</td> </tr> <tr> <td><strong>Effort</strong></td> <td>~1 dag</td> </tr> </tbody> </table> <p><strong>Stories:</strong></p> <table> <thead> <tr> <th>ID</th> <th>Story</th> <th>Priority</th> <th>Detail ref</th> </tr> </thead> <tbody> <tr> <td>E3.1</td> <td>Error/reason code registry: E_TRACE_NOT_FOUND, E_JUDGE_UNAVAILABLE, E_CFG_PARSE, etc.; mapping naar exit 0/&frac12;/3</td> <td>P0</td> <td>§3</td> </tr> <tr> <td>E3.2</td> <td>summary.json: <code>schema_version</code>, <strong><code>reason_code_version: 1</code></strong>, <code>reason_code</code> (+ message); versioned en stabiel</td> <td>P0</td> <td>§3</td> </tr> <tr> <td>E3.3</td> <td><strong>Compat switch:</strong> <code>--exit-codes=v2</code> (default na migratie), <code>--exit-codes=v1</code> (legacy, optioneel deprecation warning); env <code>ASSAY_EXIT_CODES=v1|v2</code> voor CI</td> <td>P0</td> <td>§3</td> </tr> <tr> <td>E3.4</td> <td>reason_code in <strong>alle</strong> outputs: console (laatste regels), job summary, summary.json, SARIF ruleId/helpUri (indien van toepassing); downstream tooling op reason_code schakelen, niet op exit code</td> <td>P0</td> <td>§3</td> </tr> <tr> <td>E3.5</td> <td>Docs + deprecation: run.md, troubleshooting.md, ADR-019 compatibility</td> <td>P0</td> <td>§3</td> </tr> </tbody> </table> <p><strong>Acceptance criteria:</strong></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Missing trace → exit 2, reason_code E_TRACE_NOT_FOUND (v2); v1 legacy beschikbaar via --exit-codes=v1.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Judge unavailable (mock) → exit 3, reason_code E_JUDGE_UNAVAILABLE.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> summary.json bevat reason_code_version; reason_code in console, job summary, summary.json (en waar van toepassing SARIF).</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> run.md en troubleshooting.md in lijn met gedrag; ADR-019 compatibility beschreven.</li> </ul> <hr> <h3 id=epic-e4-ergonomie-debuggability>Epic E4: Ergonomie &amp; debuggability<a class=headerlink href=#epic-e4-ergonomie-debuggability title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td><strong>Goal</strong></td> <td>Elke fout met concrete next step; performance-DX (slowest 5, cache, phase timings); progress N/M.</td> </tr> <tr> <td><strong>Priority</strong></td> <td>P1</td> </tr> <tr> <td><strong>Effort</strong></td> <td>~1–2 dagen</td> </tr> </tbody> </table> <p><strong>Stories:</strong></p> <table> <thead> <tr> <th>ID</th> <th>Story</th> <th>Priority</th> <th>Detail ref</th> <th>Status</th> </tr> </thead> <tbody> <tr> <td>E4.1</td> <td>Next step in errors: <code>suggest_next_steps(exit_code, reason_code, context)</code> in run/ci/doctor; troubleshooting per-error next steps</td> <td>P1</td> <td>§4.1</td> <td></td> </tr> <tr> <td>E4.2</td> <td>Performance DX: slowest 5 tests, cache hit rate, phase timings in console + summary.json</td> <td>P1</td> <td>§4.2</td> <td></td> </tr> <tr> <td>E4.3</td> <td>Progress UX: N/M tests, optioneel ETA in console</td> <td>P1</td> <td>§4.3</td> <td>✅ PR <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/164 title="GitHub Issue: Rul1an/assay #164">#164</a></td> </tr> </tbody> </table> <p><strong>Acceptance criteria:</strong></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Config/trace/test failure → stdout bevat minstens één suggestie (assay doctor / explain / baseline).</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> summary.json bevat slowest_tests (max 5), cache_hit_rate, phase_timings; console toont ze.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Suite met 10+ tests → console toont progress (bijv. 3/10). ✅ PR <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/164 title="GitHub Issue: Rul1an/assay #164">#164</a> (JoinSet, throttle, formatter tests).</li> </ul> <hr> <h3 id=epic-e5-observability-privacy-defaults>Epic E5: Observability &amp; privacy defaults<a class=headerlink href=#epic-e5-observability-privacy-defaults title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td><strong>Goal</strong></td> <td>Default geen prompt/response-export; in 2026 "table stakes". Concreet: prompts/response bodies nooit in OTel events, replay bundles, SARIF, job summary; alleen hashes/digests of truncated safe snippets opt-in.</td> </tr> <tr> <td><strong>Priority</strong></td> <td>P1</td> </tr> <tr> <td><strong>Effort</strong></td> <td>~0,5 dag (naast P1 SOTA OTel)</td> </tr> </tbody> </table> <p><strong>Stories:</strong></p> <table> <thead> <tr> <th>ID</th> <th>Story</th> <th>Priority</th> <th>Detail ref</th> </tr> </thead> <tbody> <tr> <td>E5.1</td> <td>Privacy default: do-not-store-prompts default on; <strong>concreet</strong> nooit in: OTel events, replay bundles, SARIF, job summary; alleen hashes/digests of truncated safe snippets opt-in</td> <td>P1</td> <td>§5</td> </tr> <tr> <td>E5.2</td> <td><strong>Golden tests</strong> op exports: default config → geen prompt/response body in OTel, replay, SARIF, summary</td> <td>P1</td> <td>§5</td> </tr> </tbody> </table> <p><strong>Acceptance criteria:</strong></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Golden tests: export (OTel, replay, SARIF, job summary) met default bevat geen prompt/response body.</li> </ul> <hr> <h3 id=epic-e6-p13-mcp-auth-hardening-security-baseline>Epic E6: P1.3 MCP Auth Hardening (Security baseline)<a class=headerlink href=#epic-e6-p13-mcp-auth-hardening-security-baseline title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td><strong>Goal</strong></td> <td>OAuth 2.0 Security BCP; RFC 8707 resource; geen pass-through; JWT alg/typ/crit; JWKS + DPoP hardening.</td> </tr> <tr> <td><strong>Priority</strong></td> <td>P1 SOTA (<strong>E6a = hard P1</strong>, <strong>E6b = optional P1+</strong>)</td> </tr> <tr> <td><strong>Effort</strong></td> <td>E6a: 2 dagen; E6b: +1 dag (optioneel, feature flag)</td> </tr> </tbody> </table> <p><strong>Scope split (beheersbare delivery):</strong></p> <table> <thead> <tr> <th>Tier</th> <th>Scope</th> <th>Rationale</th> </tr> </thead> <tbody> <tr> <td><strong>E6a (hard P1)</strong></td> <td>Resource indicators (RFC 8707), iss/aud/exp/nbf, JWKS caching + rotation + kid-miss + max-keys, alg whitelist (RS256/ES256), typ check, crit reject, no pass-through</td> <td>Core security baseline; hard invariant</td> </tr> <tr> <td><strong>E6b (optional P1+)</strong></td> <td>DPoP + jti replay cache; htu/htm strict checks</td> <td>Sender-constrained tokens; edge cases; feature flag <code>auth.require_dpop: bool</code></td> </tr> </tbody> </table> <p><strong>Stories:</strong></p> <table> <thead> <tr> <th>ID</th> <th>Story</th> <th>Priority</th> <th>Detail ref</th> </tr> </thead> <tbody> <tr> <td>E6a.1</td> <td>Resource indicators (RFC 8707): resource/iss/aud/exp/nbf; JWKS cache + rotation</td> <td><strong>P1 (hard)</strong></td> <td>§8.1.1, 8.1.5</td> </tr> <tr> <td>E6a.2</td> <td>Alg/typ/crit hardening: whitelist RS256/ES256; typ check; unknown crit → reject</td> <td><strong>P1 (hard)</strong></td> <td>§8.1.3</td> </tr> <tr> <td>E6a.3</td> <td>No pass-through: incoming token nooit doorgegeven; downstream altijd eigen token + ander aud</td> <td><strong>P1 (hard)</strong></td> <td>§8.1.6</td> </tr> <tr> <td>E6b.1</td> <td>DPoP (optioneel): jti replay cache; htu/htm strict; behind feature flag</td> <td><strong>P1+ (optional)</strong></td> <td>§8.1.2, 8.1.4</td> </tr> <tr> <td>E6.4</td> <td>Negative test suite: token validation, alg/typ/crit, JWKS rotation, resource mismatch, no pass-through, DPoP replay</td> <td>P1</td> <td>§8.1.6</td> </tr> </tbody> </table> <p><strong>Acceptance criteria:</strong></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>E6a DoD:</strong> resource + iss/aud; alg/typ/crit tests; JWKS stale-while-revalidate + kid-miss + max-keys; no pass-through bewezen; config gedocumenteerd.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>E6b DoD (optional):</strong> DPoP jti replay cache + htu/htm strict (when enabled via feature flag).</li> </ul> <hr> <h3 id=epic-e7-p11-judge-reliability-mvp>Epic E7: P1.1 Judge Reliability MVP<a class=headerlink href=#epic-e7-p11-judge-reliability-mvp title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td><strong>Goal</strong></td> <td>Minder flaky CI: borderline band, randomized order default, rerun on instability, 2-of-3, policy per suite type.</td> </tr> <tr> <td><strong>Priority</strong></td> <td>P1 SOTA</td> </tr> <tr> <td><strong>Effort</strong></td> <td>2–3 dagen (+1 tuning)</td> </tr> </tbody> </table> <p><strong>Stories:</strong></p> <table> <thead> <tr> <th>ID</th> <th>Story</th> <th>Priority</th> <th>Detail ref</th> </tr> </thead> <tbody> <tr> <td>E7.1</td> <td>Borderline band + rerun strategy: TwoOfThree, triggers = borderline + low_margin + order_flip + high_variance</td> <td>P1</td> <td>§8.2.1, 8.2.4, 8.2.5</td> </tr> <tr> <td>E7.2</td> <td>Randomized order default: seed in <strong>summary.json én job summary</strong> (zodat reviewers direct zien); OrderStrategy config</td> <td>P1</td> <td>§8.2.2</td> </tr> <tr> <td>E7.3</td> <td>Order-invariance + metrics: order_invariance_rate, flip_rate, abstain_rate, margin</td> <td>P1</td> <td>§8.2.3, 8.2.6</td> </tr> <tr> <td>E7.4</td> <td>Policy per suite type: security=fail_closed, quality=quarantine, regression=fail_on_confident</td> <td>P1</td> <td>§8.2.7</td> </tr> <tr> <td>E7.5</td> <td>Reason codes E_JUDGE_UNCERTAIN, E_JUDGE_UNAVAILABLE; exit_codes.rs + policy.rs</td> <td>P1</td> <td>§8.2.8</td> </tr> <tr> <td>E7.6</td> <td><strong>Cost guardrails:</strong> rerun is duur; <strong>cap: <code>judge.max_extra_calls_per_run</code></strong> (default 2); logs warning bij limiet</td> <td>P1</td> <td>§8.2</td> </tr> </tbody> </table> <p><strong>Acceptance criteria:</strong></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> DoD §8.2.10: randomized order + seed (summary.json + job summary); rerun-on-instability; <strong>max extra judge calls per run</strong>; config-first policies; metrics in CI-run; multi-judge placeholder.</li> </ul> <hr> <h3 id=epic-e8-p12-otel-genai-observability>Epic E8: P1.2 OTel GenAI (Observability)<a class=headerlink href=#epic-e8-p12-otel-genai-observability title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td><strong>Goal</strong></td> <td>OTel GenAI semconv compliance; version gating; low-cardinality metrics; composable redaction.</td> </tr> <tr> <td><strong>Priority</strong></td> <td>P1 SOTA</td> </tr> <tr> <td><strong>Effort</strong></td> <td>1–2 dagen</td> </tr> </tbody> </table> <p><strong>Stories:</strong></p> <table> <thead> <tr> <th>ID</th> <th>Story</th> <th>Priority</th> <th>Detail ref</th> </tr> </thead> <tbody> <tr> <td>E8.1</td> <td>Semconv version gating: config + manifest; versioned span attributes</td> <td>P1</td> <td>§8.3.1</td> </tr> <tr> <td>E8.2</td> <td>Spans + metrics (GenAI semconv); <strong>low-cardinality enforcement</strong> + <strong>cardinality budget tests</strong> + <strong>"reject dynamic labels" guard</strong> in code</td> <td>P1</td> <td>§8.3.2, 8.3.3</td> </tr> <tr> <td>E8.3</td> <td>Composable redaction policies; golden tests default vs full</td> <td>P1</td> <td>§8.3.4</td> </tr> </tbody> </table> <p><strong>Acceptance criteria:</strong></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> DoD §8.3.5: semconv version in config/manifest; cardinality tests; redaction golden tests; config observability.md.</li> </ul> <hr> <h3 id=epic-e9-replay-bundle-dx-forensic>Epic E9: Replay Bundle (DX + forensic)<a class=headerlink href=#epic-e9-replay-bundle-dx-forensic title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td><strong>Goal</strong></td> <td>Reproduceerbare run uit één artifact; toolchain + seeds in manifest; scrubbed cassettes.</td> </tr> <tr> <td><strong>Priority</strong></td> <td>P1 SOTA</td> </tr> <tr> <td><strong>Effort</strong></td> <td>2–3 dagen</td> </tr> </tbody> </table> <p><strong>Stories:</strong></p> <table> <thead> <tr> <th>ID</th> <th>Story</th> <th>Priority</th> <th>Detail ref</th> </tr> </thead> <tbody> <tr> <td>E9.1</td> <td>Bundle format + manifest: file digests, git_sha, workflow_run_id</td> <td>P1</td> <td>§8.4.1</td> </tr> <tr> <td>E9.2</td> <td>Toolchain capture: rustc, cargo, Cargo.lock, cargo metadata, runner metadata</td> <td>P1</td> <td>§8.4.2</td> </tr> <tr> <td>E9.3</td> <td>Deterministic seed logging: judge_order_seed, random_seed in manifest</td> <td>P1</td> <td>§8.4.3</td> </tr> <tr> <td>E9.4</td> <td>Scrubbed cassettes policy + tests; include_prompts false default; <strong>scrubbing "deny-by-default"</strong> (allowlist, niet blocklist)</td> <td>P1</td> <td>§8.4.4, 8.4.5</td> </tr> <tr> <td>E9.5</td> <td>CLI: <code>assay bundle create</code>, <code>assay replay --bundle [--live] [--seed N]</code></td> <td>P1</td> <td>§8.4.6</td> </tr> </tbody> </table> <p><strong>Acceptance criteria:</strong></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> DoD §8.4.7: toolchain + seeds in manifest; replay roundtrip; scrubbed policy getest; signature placeholder.</li> </ul> <hr> <h3 id=epics-volgorde-afhankelijkheden>Epics: volgorde &amp; afhankelijkheden<a class=headerlink href=#epics-volgorde-afhankelijkheden title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Fase</th> <th>Epics</th> <th>Opmerking</th> </tr> </thead> <tbody> <tr> <td><strong>P0 (default gate)</strong></td> <td>E1 (E1.1, E1.2), E2 (E2.1, E2.2), E3</td> <td>Parallel waar mogelijk</td> </tr> <tr> <td><strong>P1 DX</strong></td> <td>E1.3, E2.3, E2.4, E4, E5</td> <td>E4.1, E4.2, E5 kunnen parallel</td> </tr> <tr> <td><strong>P1 SOTA</strong></td> <td>E6 → E7 → E8 → E9</td> <td>E6 eerst (security); E9 gebruikt output E7/E8</td> </tr> </tbody> </table> <p><strong>Totale effort (indicatief):</strong> P0 ~3–4 dagen, P1 DX ~2–3 dagen, P1 SOTA ~8–12 dagen (zie §8.6).</p> <hr> <h2 id=1-first-15-minutes-init-as-blessed-on-ramp>1. First 15 minutes: init as blessed on-ramp<a class=headerlink href=#1-first-15-minutes-init-as-blessed-on-ramp title="Permanent link">&para;</a></h2> <h3 id=11-template-drift-v1-v2-action-in-init-ci>1.1 Template drift (v1 → v2 action in init --ci)<a class=headerlink href=#11-template-drift-v1-v2-action-in-init-ci title="Permanent link">&para;</a></h3> <p><strong>Problem:</strong> <code>assay init --ci</code> (and <code>assay init-ci --provider github</code>) generate a workflow that uses <code>assay-action@v1</code> and <code>assay_version: "v1.4.0"</code>, while the recommended and documented action is <code>assay-action@v2</code>. Trust break in minute 5.</p> <p><strong>Fix:</strong> Init-generated GitHub workflow MUST use the blessed v2 template. <strong>Belangrijk:</strong> GitHub Actions ondersteunt geen semver ranges in <code>uses: owner/repo@ref</code>. Opties: moving major tag <code>@v2</code> (aanbevolen DX-default), exact tag <code>@v2.12.3</code>, of pinned SHA voor supply-chain strictness.</p> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-cli/src/templates.rs</code></td> <td>Replace <code>CI_WORKFLOW_YML</code>: <code>uses: Rul1an/assay-action@v1</code> → <strong><code>uses: Rul1an/assay/assay-action@v2</code></strong> (canonieke vorm: action in subdirectory). Geen <code>version: "2.x"</code> (niet ondersteund); template gebruikt <a class="magiclink magiclink-github magiclink-mention" href=https://github.com/v2 title="GitHub User: v2">@v2</a>. Optioneel comment: "Voor supply-chain strictness: pin op exacte tag of SHA + Dependabot."</td> </tr> <tr> <td><code>docs/getting-started/ci-integration.md</code> (or equivalent)</td> <td>"assay init --ci genereert workflow met <code>Rul1an/assay/assay-action@v2</code>. Voor supply-chain strictness: pin op exacte tag of SHA; zie CHANGELOG."</td> </tr> <tr> <td><code>docs/reference/cli/init.md</code></td> <td>Init --ci / init-ci github schrijft de <strong>blessed</strong> workflow; output pad is <strong><code>.github/workflows/assay.yml</code></strong> (contractueel).</td> </tr> </tbody> </table> <p><strong>Test cases:</strong></p> <ul> <li><code>assay init --ci</code> in empty dir → <code>.github/workflows/assay.yml</code> bevat <strong>exact</strong> <code>Rul1an/assay/assay-action@v2</code> en geen v1-referentie (expliciete assertion op deze string in contract test).</li> <li><code>assay init-ci --provider github</code> → zelfde output.</li> <li>Golden snapshot van <code>CI_WORKFLOW_YML</code> in tests (e.g. <code>tests/fixtures/contract/</code>) met assertion op action path.</li> </ul> <hr> <h3 id=12-one-blessed-entrypoint-init-ci-vs-init-ci>1.2 One blessed entrypoint: init --ci vs init-ci<a class=headerlink href=#12-one-blessed-entrypoint-init-ci-vs-init-ci title="Permanent link">&para;</a></h3> <p><strong>Problem:</strong> Two ways to do the same thing (<code>assay init --ci</code> vs <code>assay init-ci</code>) weakens "one blessed flow" (ADR-019).</p> <p><strong>Fix:</strong> Choose one as blessed; document the other as alias.</p> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>docs/DX-REVIEW-MATERIALS.md</code></td> <td>In A.1, state: "Blessed: <code>assay init --ci</code> (and <code>assay init --ci github</code>). <code>assay init-ci --provider github</code> is an alias that writes the same workflow."</td> </tr> <tr> <td><code>docs/guides/user-guide.md</code></td> <td>Recommend <code>assay init --ci</code> for first-time setup; mention <code>assay init-ci</code> as alternative that does the same.</td> </tr> <tr> <td><code>docs/reference/cli/init.md</code></td> <td>Document <code>--ci</code> and <code>--ci github</code>; add "See also: assay init-ci (alias for CI-only workflow generation)."</td> </tr> <tr> <td><code>crates/assay-cli/src/cli/commands/init_ci.rs</code></td> <td>No code change required; optionally add a single println hint: "Tip: You can also run 'assay init --ci' for full init + CI." so both paths are discoverable.</td> </tr> </tbody> </table> <p><strong>Decision (to document):</strong> Blessed = <code>assay init --ci</code>. <code>assay init-ci</code> remains as alias (no removal) to avoid breaking existing scripts.</p> <p><strong>Test cases:</strong></p> <ul> <li>Both commands produce byte-identical <code>.github/workflows/assay.yml</code> when using same provider (after 1.1 is done).</li> </ul> <hr> <h3 id=13-one-click-dx-demo-repos-p1>1.3 One-click DX demo repos (P1)<a class=headerlink href=#13-one-click-dx-demo-repos-p1 title="Permanent link">&para;</a></h3> <p><strong>Problem:</strong> No minimal Node/Python example repo that demonstrates 0 → CI gate (clone, run, PR with annotations).</p> <p><strong>Fix:</strong> Add two example directories with minimal app + 1 test + working workflow + baseline flow.</p> <table> <thead> <tr> <th>File / Dir</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>examples/dx-demo-node/</code></td> <td><strong>New.</strong> Minimal Node app (e.g. one script + one test), <code>assay.yaml</code>, <code>policy.yaml</code>, <code>ci-eval.yaml</code> (or equivalent), <code>.github/workflows/assay.yml</code> (blessed v2), <code>traces/</code> with one trace, README: "0 → CI: clone, npm install, assay run..., open PR." Include baseline: first run baseline export, CI compare.</td> </tr> <tr> <td><code>examples/dx-demo-python/</code></td> <td><strong>New.</strong> Same idea for Python (pyproject.toml or requirements.txt, one test, assay config, workflow, traces, README, baseline flow).</td> </tr> <tr> <td><code>docs/DX-REVIEW-MATERIALS.md</code></td> <td>In A.2, replace "geen aparte minimale Node- of Python-voorbeeldrepo" with pointer: "See examples/dx-demo-node and examples/dx-demo-python for one-click 0→CI demos."</td> </tr> <tr> <td><code>docs/getting-started/ci-integration.md</code></td> <td>Add subsection "Example repos" linking to <code>examples/dx-demo-node</code> and <code>examples/dx-demo-python</code>.</td> </tr> </tbody> </table> <p><strong>Test cases:</strong></p> <ul> <li>CI job in this repo (or local) runs <code>assay run</code> in <code>examples/dx-demo-node</code> and <code>examples/dx-demo-python</code> and exits 0 (or document as manual smoke).</li> </ul> <hr> <h2 id=2-pr-feedback-ux>2. PR feedback UX<a class=headerlink href=#2-pr-feedback-ux title="Permanent link">&para;</a></h2> <h3 id=21-junit-default-native-annotations-blessed-snippet>2.1 JUnit: default + native annotations (blessed snippet)<a class=headerlink href=#21-junit-default-native-annotations-blessed-snippet title="Permanent link">&para;</a></h3> <p><strong>Problem:</strong> JUnit is not default in the action; no single blessed snippet for "failures as annotations" and "where is junit.xml".</p> <p><strong>Fix:</strong> Action heeft escape hatch (teams willen soms alleen SARIF of alleen job summary). Default "works", geen lock-in.</p> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>assay-action/action.yml</code></td> <td><strong>Action inputs:</strong> <code>junit: true</code> (default true), <code>sarif: true</code> (default true, same-repo only), <code>comment: auto|always|never</code> (default auto). Stap die assay draait: schrijft JUnit naar <strong>contractueel pad</strong> <code>.assay/reports/junit.xml</code> (of configureerbaar pad). Upload artifact + één <strong>blessed</strong> JUnit reporter (gekozen en gepind: SHA of vaste tag) voor annotations. Pad vastgelegd in docs + tests + action.</td> </tr> <tr> <td><code>docs/reference/cli/run.md</code></td> <td><strong>"Failures as annotations"</strong>: één blessed YAML snippet (assay run met <code>--junit</code>, upload artifact + JUnit report action). <strong>"Where is junit.xml"</strong>: contractueel pad <code>.assay/reports/junit.xml</code> (of <code>--junit</code> override); vastgelegd in docs + contract test.</td> </tr> <tr> <td><code>docs/DX-REVIEW-MATERIALS.md</code></td> <td>B.1: "Action inputs junit/sarif/comment; blessed snippet; pad contractueel."</td> </tr> </tbody> </table> <p><strong>Test cases:</strong></p> <ul> <li>Contract test: output path voor JUnit is het gekozen pad (default <code>.assay/reports/junit.xml</code>).</li> <li>CI workflow met blessed snippet produceert JUnit artifact en annotations bij failure (manual of e2e).</li> </ul> <hr> <h3 id=22-sarif-always-one-location-upload-contract-limits-p0p1>2.2 SARIF: always one location + upload contract + limits (P0/P1)<a class=headerlink href=#22-sarif-always-one-location-upload-contract-limits-p0p1 title="Permanent link">&para;</a></h3> <p><strong>Problem:</strong> GitHub upload can fail with "expected at least one location". No contract test. No handling for result/size limits.</p> <p><strong>Fix:</strong></p> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-core/src/report/sarif.rs</code></td> <td><strong>write_sarif:</strong> Each result MUST include at least one <code>locations</code> entry. If no file/line from TestResultRow, use a synthetic location (e.g. <code>assay.yaml</code> or config path from context). Same for <strong>build_sarif_diagnostics:</strong> when <code>locations</code> is empty, use synthetic location (e.g. <code>"assay.yaml"</code> or <code>"policy.yaml"</code>).</td> </tr> <tr> <td><code>assay-evidence</code> (if it emits SARIF)</td> <td>Same rule: every result has ≥1 location; synthetic if needed.</td> </tr> <tr> <td>Contract test (new or in existing)</td> <td>Add test: SARIF output from assay run (or build_sarif_diagnostics) is valid and accepted by GitHub upload (snapshot + schema validation; optional: real upload in CI with small result set).</td> </tr> <tr> <td><code>crates/assay-core/src/report/sarif.rs</code> (or report pipeline)</td> <td><strong>Limits:</strong> When result count or SARIF size exceeds GitHub limits, truncate and add a "N results omitted" (or similar) message in run summary / SARIF run description; configurable or default truncation threshold.</td> </tr> </tbody> </table> <p><strong>Test cases:</strong></p> <ul> <li>Unit: every result in generated SARIF has <code>locations</code> length ≥ 1.</li> <li>Contract: generated SARIF passes schema 2.1.0 and contains at least one location per result.</li> <li>Optional: CI step that uploads a minimal SARIF (1 result, 1 location) to verify upload-sarif accepts it.</li> </ul> <hr> <h3 id=23-fork-pr-no-sarifcomment-fallback-to-job-summary-p1>2.3 Fork PR: no SARIF/comment; fallback to job summary (P1)<a class=headerlink href=#23-fork-pr-no-sarifcomment-fallback-to-job-summary-p1 title="Permanent link">&para;</a></h3> <p><strong>Problem:</strong> Fork PRs cannot upload SARIF or post comments (permissions). Users should get feedback only via job summary.</p> <p><strong>Fix:</strong> Job summary <strong>altijd</strong> kernresultaten bevatten, zodat devs bij beperkte permissies toch feedback zien (ook bij "expected checks" zonder artifacts).</p> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>assay-action/action.yml</code></td> <td>Al conditioneel op same-repo voor SARIF/comment. Expliciet in comments/docs: fork PRs = geen SARIF upload, geen PR comment. <strong>Job summary (GitHub step summary) altijd schrijven met kernresultaten</strong> (pass/fail count, reason_code indien van toepassing) zodat fork PR's feedback krijgen.</td> </tr> <tr> <td><code>docs/DX-REVIEW-MATERIALS.md</code> or CI docs</td> <td>"Fork PRs: SARIF upload en PR comment worden overgeslagen (GitHub permissions). Job summary bevat altijd kernresultaten."</td> </tr> <tr> <td><code>docs/getting-started/ci-integration.md</code></td> <td>"On fork PRs, only the job summary is updated with core results; SARIF and PR comment require same-repo."</td> </tr> </tbody> </table> <p><strong>Test cases:</strong></p> <ul> <li>Documented behaviour; optional: trigger from fork en assert no upload/comment, summary bevat kernresultaten.</li> </ul> <hr> <h2 id=3-exit-codes-remove-dx-landmine-p0>3. Exit codes: remove DX landmine (P0)<a class=headerlink href=#3-exit-codes-remove-dx-landmine-p0 title="Permanent link">&para;</a></h2> <p><strong>Problem:</strong> run.md says exit 3 = "Trace file not found"; ADR-019 wants 3 = "infra/judge unavailable". Redefining 3 breaks existing users/CI.</p> <p><strong>Fix (SOTA):</strong> Stable, machine-readable <strong>reason code registry</strong> (decoupled from exit code). Coarse exit codes 0/&frac12;/3; <strong>expliciete compat switch</strong>; reason_code in <strong>alle</strong> outputs; downstream tooling schakelt op reason_code, niet op exit code.</p> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-cli</code> (e.g. <code>exit_codes.rs</code>)</td> <td>Reason code registry: E_TRACE_NOT_FOUND, E_JUDGE_UNAVAILABLE, E_CFG_PARSE, etc. Mapping naar exit 0/&frac12;/3. <strong>Compat:</strong> <code>--exit-codes=v2</code> (default na migratie), <code>--exit-codes=v1</code> (legacy; optioneel deprecation warning). Env <strong><code>ASSAY_EXIT_CODES=v1|v2</code></strong> voor CI.</td> </tr> <tr> <td>Summary.json / report pipeline</td> <td>Elke non-zero exit: <strong><code>schema_version</code></strong>, <strong><code>reason_code_version: 1</code></strong>, <strong><code>reason_code</code></strong> (+ message). Versioned en stabiel voor toekomstige uitbreidingen.</td> </tr> <tr> <td>Console / job summary / SARIF</td> <td><strong>reason_code in alle outputs:</strong> console (laatste regels), job summary, summary.json, SARIF ruleId/helpUri waar van toepassing. Grepable debugging.</td> </tr> <tr> <td><code>docs/architecture/ADR-019-PR-Gate-2026-SOTA.md</code></td> <td>Compatibility: "Exit code 3 = infra/judge unavailable. Trace-not-found = exit 2 + E_TRACE_NOT_FOUND. Gebruik --exit-codes=v1 voor legacy; downstream op reason_code schakelen."</td> </tr> <tr> <td><code>docs/reference/cli/run.md</code></td> <td>Exit codes table 0/&frac12;/3; "Reason codes" → registry; "Legacy: exit 3 was 'trace file not found'; use summary.json reason_code for stable behaviour."</td> </tr> <tr> <td><code>docs/guides/troubleshooting.md</code></td> <td>Trace file not found onder Exit 2; Judge/infra onder Exit 3.</td> </tr> </tbody> </table> <p><strong>Test cases:</strong></p> <ul> <li>Missing trace → exit 2, reason_code E_TRACE_NOT_FOUND (v2); met --exit-codes=v1 → legacy exit 3.</li> <li>Judge unavailable (mock) → exit 3, reason_code E_JUDGE_UNAVAILABLE.</li> <li>reason_code aanwezig in console output, summary.json (incl. reason_code_version), en waar van toepassing job summary/SARIF.</li> <li>run.md and troubleshooting.md match behaviour.</li> </ul> <hr> <h2 id=4-ergonomie-debuggability>4. Ergonomie &amp; debuggability<a class=headerlink href=#4-ergonomie-debuggability title="Permanent link">&para;</a></h2> <h3 id=41-default-next-step-in-every-error-p1>4.1 Default "next step" in every error (P1)<a class=headerlink href=#41-default-next-step-in-every-error-p1 title="Permanent link">&para;</a></h3> <p><strong>Problem:</strong> Not every exit≠0 ends with 1–2 concrete commands. Te veel next steps = noise; niemand leest het.</p> <p><strong>Fix:</strong> <strong>Context-aware</strong> next steps; <strong>max 2</strong> per exit.</p> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-cli</code> (run/ci/doctor paths)</td> <td>Centraliseer in <code>suggest_next_steps(exit_code, reason_code, context)</code>. <strong>Context-aware</strong> voorbeelden: E_TRACE_NOT_FOUND → "check path, run assay doctor, list traces"; E_CFG_PARSE → "assay doctor --config …"; E_JUDGE_UNAVAILABLE → "retry, check rate limits, enable VCR replay, set backoff". <strong>Beperk tot max 2 next steps</strong> per exit.</td> </tr> <tr> <td><code>docs/guides/troubleshooting.md</code></td> <td>"Next steps" per error type; elk sectie eindigt met concrete command(s); max 2 per type.</td> </tr> </tbody> </table> <p><strong>Test cases:</strong></p> <ul> <li>Trigger config error, missing trace, failing test; stdout bevat max 2 suggesties (assay doctor / explain / baseline, context-afhankelijk).</li> </ul> <hr> <h3 id=42-performance-dx-slowest-5-cache-hit-rate-phase-timings-p1>4.2 Performance-DX: slowest 5, cache hit rate, phase timings (P1)<a class=headerlink href=#42-performance-dx-slowest-5-cache-hit-rate-phase-timings-p1 title="Permanent link">&para;</a></h3> <p><strong>Problem:</strong> No "slowest 5 tests", "cache hit rate", or "total time per phase" in console or summary.</p> <p><strong>Fix:</strong></p> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-core/src/report/console.rs</code> (and summary pipeline)</td> <td>Na run: slowest_tests (max 5), cache (hit_rate, hits, misses), timings (phase: ms). Stabiel schema in summary.json.</td> </tr> <tr> <td><code>docs/reference/cli/run.md</code> or report docs</td> <td>Document summary fields: slowest_tests[], cache.{hit_rate,hits,misses}, timings.{phase}. Cap slowest 5.</td> </tr> </tbody> </table> <p><strong>Test cases:</strong></p> <ul> <li>Run suite with multiple tests; summary.json contains slowest_tests (max 5), cache, timings; console shows them.</li> </ul> <hr> <h3 id=43-progress-ux-nm-tests-eta-ish-p1>4.3 Progress UX: N/M tests, ETA-ish (P1)<a class=headerlink href=#43-progress-ux-nm-tests-eta-ish-p1 title="Permanent link">&para;</a></h3> <p><strong>Problem:</strong> Long suites have no "N/M done, ETA" feedback.</p> <p><strong>Fix:</strong></p> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-core</code> (runner or report)</td> <td>Emit progress updates: e.g. "Running test 3/10..." and optional "ETA ~Xs" (simple linear estimate). No fancy progress bar required.</td> </tr> <tr> <td><code>docs/DX-REVIEW-MATERIALS.md</code></td> <td>C.4: "Progress: N/M tests, optional ETA in console."</td> </tr> </tbody> </table> <p><strong>Test cases:</strong></p> <ul> <li>Run suite with 10+ tests; console shows progress lines (e.g. 3/10).</li> </ul> <hr> <h2 id=5-observability-privacy-safe-defaults-p1>5. Observability: privacy-safe defaults (P1)<a class=headerlink href=#5-observability-privacy-safe-defaults-p1 title="Permanent link">&para;</a></h2> <p><strong>Problem:</strong> GenAI events (prompt/response capture) are not everywhere; default should not export prompt/response content. In 2026 is dit "table stakes".</p> <p><strong>Fix:</strong> <strong>Concreet</strong> waar prompts/response bodies nooit mogen staan (default):</p> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td>Default (geen opt-in)</td> <td>Prompts/response bodies <strong>nooit</strong> in: OTel events, replay bundles, SARIF, job summary. Alleen hashes/digests of truncated safe snippets als <strong>opt-in</strong>.</td> </tr> <tr> <td>CLI / config</td> <td>"do-not-store-prompts" (of equivalent) default on. Document in run/reference.</td> </tr> <tr> <td>Tests</td> <td><strong>Golden tests</strong> op exports: default config → geen prompt/response body in OTel export, replay bundle, SARIF output, job summary.</td> </tr> </tbody> </table> <p><strong>Test cases:</strong></p> <ul> <li>Golden tests: OTel export, replay bundle, SARIF, job summary met default config bevatten geen prompt/response body (of alleen hash/digest indien gedocumenteerd).</li> </ul> <hr> <h2 id=6-backlog-summary-copy-paste-for-issues>6. Backlog summary (copy-paste for issues)<a class=headerlink href=#6-backlog-summary-copy-paste-for-issues title="Permanent link">&para;</a></h2> <p>Elk item is gekoppeld aan een epic (zie §0).</p> <h3 id=p0-must-have-before-default-gate>P0 (must-have before default gate)<a class=headerlink href=#p0-must-have-before-default-gate title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>#</th> <th>Epic</th> <th>Item</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>E1.1</td> <td><strong>Template v2:</strong> <code>templates.rs</code> CI_WORKFLOW_YML → assay-action@v2, semver pin; docs init/ci-integration align.</td> </tr> <tr> <td>2</td> <td>E1.2</td> <td><strong>Blessed entrypoint:</strong> Document init --ci as blessed, init-ci as alias (docs only).</td> </tr> <tr> <td>3</td> <td>E2.2</td> <td><strong>SARIF locations:</strong> assay-core (and assay-evidence if applicable) guarantee ≥1 location per result; synthetic if needed.</td> </tr> <tr> <td>4</td> <td>E2.2</td> <td><strong>SARIF contract test:</strong> Snapshot + schema + optional upload smoke for SARIF output.</td> </tr> <tr> <td>5</td> <td>E3</td> <td><strong>Exit code 3 + registry:</strong> Reason code registry; summary.json met schema_version + reason_code_version: 1 + reason_code; <strong>compat switch</strong> --exit-codes=v2 (default) / v1 (legacy), ASSAY_EXIT_CODES env; reason_code in console, job summary, summary.json, SARIF; run.md + troubleshooting.md.</td> </tr> <tr> <td>6</td> <td>E2.1</td> <td><strong>JUnit:</strong> Action inputs junit/sarif/comment met defaults + escape hatch; run.md blessed snippet; contractueel pad .assay/reports/junit.xml; één blessed reporter gepind.</td> </tr> </tbody> </table> <h3 id=p1-sota>P1 (SOTA)<a class=headerlink href=#p1-sota title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>#</th> <th>Epic</th> <th>Item</th> </tr> </thead> <tbody> <tr> <td>7</td> <td>E1.3</td> <td><strong>DX demo repos:</strong> examples/dx-demo-node, examples/dx-demo-python (minimal app, 1 test, workflow, baseline flow, README).</td> </tr> <tr> <td>8</td> <td>E2.4</td> <td><strong>Fork PR fallback:</strong> Docs: fork = job summary only; action already conditional; document clearly.</td> </tr> <tr> <td>9</td> <td>E2.3</td> <td><strong>SARIF limits:</strong> Configureerbare truncation (max results, max bytes); default safe; "N omitted"; geen magische getallen zonder config/const + docs.</td> </tr> <tr> <td>10</td> <td>E4.1</td> <td><strong>Next step in errors:</strong> suggest_next_steps() in run/ci/doctor; troubleshooting.md per-error next steps.</td> </tr> <tr> <td>11</td> <td>E4.2</td> <td><strong>Performance DX:</strong> slowest 5, cache hit rate, phase timings in console + summary.json.</td> </tr> <tr> <td>12</td> <td>E4.3</td> <td><strong>Progress:</strong> N/M tests, optional ETA in console.</td> </tr> <tr> <td>13</td> <td>E5</td> <td><strong>Privacy:</strong> do-not-store-prompts default, redaction tests.</td> </tr> </tbody> </table> <hr> <h2 id=7-file-level-checklist-patchlist>7. File-level checklist (patchlist)<a class=headerlink href=#7-file-level-checklist-patchlist title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>File / area</th> <th>P0</th> <th>P1</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-cli/src/templates.rs</code></td> <td>v2 template (<code>Rul1an/assay/assay-action@v2</code> of exact tag/SHA); output <code>.github/workflows/assay.yml</code></td> <td>—</td> </tr> <tr> <td><code>crates/assay-cli/src/cli/commands/init_ci.rs</code></td> <td>—</td> <td>Optional hint "assay init --ci"</td> </tr> <tr> <td><code>crates/assay-cli/src/cli/commands/mod.rs</code> or new</td> <td>Error code registry, exit 3 mapping</td> <td>suggest_next_steps()</td> </tr> <tr> <td><code>crates/assay-core/src/report/sarif.rs</code></td> <td>≥1 location per result; synthetic fallback</td> <td>Truncate + "N omitted"</td> </tr> <tr> <td><code>assay-evidence</code> SARIF (if any)</td> <td>≥1 location per result</td> <td>—</td> </tr> <tr> <td><code>assay-action/action.yml</code></td> <td>—</td> <td>JUnit default + annotations; fork/docs</td> </tr> <tr> <td><code>docs/reference/cli/run.md</code></td> <td>Exit codes + reason codes; JUnit snippet + path</td> <td>—</td> </tr> <tr> <td><code>docs/guides/troubleshooting.md</code></td> <td>Exit &#8532; alignment</td> <td>Next step per error</td> </tr> <tr> <td><code>docs/getting-started/ci-integration.md</code></td> <td>init v2, example repos pointer</td> <td>Fork behaviour</td> </tr> <tr> <td><code>docs/architecture/ADR-019-PR-Gate-2026-SOTA.md</code></td> <td>Compatibility: exit 3 deprecation</td> <td>—</td> </tr> <tr> <td><code>docs/DX-REVIEW-MATERIALS.md</code></td> <td>—</td> <td>Bless init --ci; JUnit/SARIF/fork notes</td> </tr> <tr> <td><code>crates/assay-core</code> report/runner</td> <td>—</td> <td>slowest 5, cache rate, phase timings, progress N/M</td> </tr> <tr> <td>New: contract test SARIF</td> <td>Schema + location invariant</td> <td>—</td> </tr> <tr> <td>New: examples/dx-demo-node, dx-demo-python</td> <td>—</td> <td>Full demo repos</td> </tr> <tr> <td>OTel / redaction</td> <td>—</td> <td>Default no prompt/response; redaction test</td> </tr> </tbody> </table> <hr> <h2 id=8-p1-sota-implementation-judge-security-observability-replay>8. P1 SOTA Implementation (Judge, Security, Observability, Replay)<a class=headerlink href=#8-p1-sota-implementation-judge-security-observability-replay title="Permanent link">&para;</a></h2> <p><strong>Status:</strong> Planned (Updated: Bleeding Edge Jan 2026) <strong>Priority Order:</strong> P1.3 → P1.1 → P1.2 → Replay Bundle <strong>Rationale:</strong> Security baseline first (hard invariant), then judge reliability (CI signal), then observability (debugging), then DX (replay). <strong>Review Score:</strong> 9.2/10 → <strong>9.7/10</strong> with bleeding edge additions below.</p> <hr> <h3 id=81-p13-mcp-auth-hardening-security-baseline>8.1 P1.3 MCP Auth Hardening (Security Baseline)<a class=headerlink href=#81-p13-mcp-auth-hardening-security-baseline title="Permanent link">&para;</a></h3> <p><strong>Goal:</strong> OAuth 2.0 Security BCP compliance + sender-constrained tokens where applicable.</p> <h4 id=811-resource-indicators-rfc-8707>8.1.1 Resource Indicators (RFC 8707)<a class=headerlink href=#811-resource-indicators-rfc-8707 title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-mcp-server/src/auth/</code></td> <td>Enforce <code>resource</code> parameter matches protected API; validate <code>iss</code>, <code>aud</code>, <code>exp</code>, <code>nbf</code> with configurable clock-skew window</td> </tr> <tr> <td><code>crates/assay-mcp-server/src/auth/jwks.rs</code></td> <td>JWKS caching with rotation support; old key revoked → reject; new key → accept</td> </tr> <tr> <td>Config</td> <td>Add <code>auth.clock_skew_seconds</code> (default 30), <code>auth.jwks_cache_ttl_seconds</code> (default 300)</td> </tr> </tbody> </table> <h4 id=812-dpop-sender-constrained-tokens-optional-hardening>8.1.2 DPoP (Sender-Constrained Tokens) — Optional Hardening<a class=headerlink href=#812-dpop-sender-constrained-tokens-optional-hardening title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-mcp-server/src/auth/dpop.rs</code></td> <td><strong>New.</strong> DPoP proof validation per RFC 9449; <code>cnf.jkt</code> thumbprint binding</td> </tr> <tr> <td>Config</td> <td><code>auth.require_dpop: bool</code> (default false for MVP, true for high-security deployments)</td> </tr> </tbody> </table> <h4 id=813-bleeding-edge-algtypcrit-hardening-jwt-footguns>8.1.3 Bleeding Edge: Alg/Typ/Crit Hardening (JWT Footguns)<a class=headerlink href=#813-bleeding-edge-algtypcrit-hardening-jwt-footguns title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Check</th> <th>Implementation</th> </tr> </thead> <tbody> <tr> <td><strong>Alg whitelist</strong></td> <td>Only <code>RS256</code>/<code>ES256</code>; <strong>reject <code>none</code></strong> and unexpected algorithms</td> </tr> <tr> <td><strong>Typ verification</strong></td> <td>Verify <code>typ</code> header (<code>JWT</code> or <code>at+jwt</code> depending on issuer); strict header parsing</td> </tr> <tr> <td><strong>Crit handling</strong></td> <td>If <code>crit</code> present and extension unknown → <strong>reject</strong> (classic bypass vector)</td> </tr> </tbody> </table> <h4 id=814-bleeding-edge-replay-defense-dpop>8.1.4 Bleeding Edge: Replay Defense (DPoP)<a class=headerlink href=#814-bleeding-edge-replay-defense-dpop title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Aspect</th> <th>Implementation</th> </tr> </thead> <tbody> <tr> <td><strong>jti replay cache</strong></td> <td>Per <code>(jti, iat)</code> window; config <code>auth.dpop_jti_cache_ttl_seconds</code></td> </tr> <tr> <td><strong>htu/htm strict</strong></td> <td>Validate HTTP method + URL exact match</td> </tr> </tbody> </table> <h4 id=815-bleeding-edge-jwks-caching-done-right>8.1.5 Bleeding Edge: JWKS Caching "Done Right"<a class=headerlink href=#815-bleeding-edge-jwks-caching-done-right title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Feature</th> <th>Implementation</th> </tr> </thead> <tbody> <tr> <td><strong>Stale-while-revalidate</strong></td> <td>Soft TTL to avoid request spikes</td> </tr> <tr> <td><strong>Kid miss → force refresh</strong></td> <td>Unknown <code>kid</code> triggers immediate refresh (rotation path)</td> </tr> <tr> <td><strong>Max key set size</strong></td> <td>Limit on number of keys (DoS prevention); config <code>auth.jwks_max_keys</code></td> </tr> </tbody> </table> <h4 id=816-negative-test-suite>8.1.6 Negative Test Suite<a class=headerlink href=#816-negative-test-suite title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Test Category</th> <th>Cases</th> </tr> </thead> <tbody> <tr> <td><strong>Token validation</strong></td> <td>expired, wrong issuer, wrong audience, invalid signature</td> </tr> <tr> <td><strong>alg/typ/crit confusion</strong></td> <td><code>alg=none</code>, unexpected algorithms, wrong <code>typ</code>, unknown <code>crit</code> extensions</td> </tr> <tr> <td><strong>JWKS rotation</strong></td> <td>old key revoked (reject), new key added (accept), cache invalidation, kid miss refresh</td> </tr> <tr> <td><strong>Resource mismatch</strong></td> <td>token <code>resource</code> ≠ requested API</td> </tr> <tr> <td><strong>No pass-through (hard proof)</strong></td> <td>incoming token never in logs/telemetry; downstream call always with different token + different <code>aud</code></td> </tr> <tr> <td><strong>DPoP replay</strong></td> <td>jti reuse rejected; htu/htm mismatch rejected</td> </tr> </tbody> </table> <h4 id=817-definition-of-done>8.1.7 Definition of Done<a class=headerlink href=#817-definition-of-done title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <code>resource</code> enforced + <code>iss</code>/<code>aud</code> validated conform OAuth BCP</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Alg/typ/crit confusion tests</strong> (bleeding edge)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> JWKS with stale-while-revalidate + kid-miss refresh + max-keys</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> DPoP jti replay cache + htu/htm strict (when enabled)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> "No pass-through" proven in tests (logs + downstream aud)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Config documented in <code>docs/reference/config/mcp-server.md</code></li> </ul> <p><strong>Effort:</strong> 2–3 days</p> <p><strong>DX Impact:</strong> Fewer "mysterious 401/403" errors — developers understand what to fix via reason codes.</p> <hr> <h3 id=82-p11-judge-reliability-mvp-ci-signalnoise>8.2 P1.1 Judge Reliability MVP (CI Signal/Noise)<a class=headerlink href=#82-p11-judge-reliability-mvp-ci-signalnoise title="Permanent link">&para;</a></h3> <p><strong>Goal:</strong> Reduce flakiness, add bias mitigation, structured uncertainty handling.</p> <h4 id=821-borderline-band-adaptive-calibration>8.2.1 Borderline Band + Adaptive Calibration<a class=headerlink href=#821-borderline-band-adaptive-calibration title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-core/src/judge/borderline.rs</code></td> <td><strong>New.</strong> <code>BorderlineBand { lower: f64, upper: f64 }</code> with default 0.4–0.6; per-suite/model calibration from historical variance</td> </tr> <tr> <td><code>crates/assay-core/src/judge/mod.rs</code></td> <td>Integrate borderline detection before final verdict</td> </tr> <tr> <td>Config</td> <td><code>judge.borderline_band: [0.4, 0.6]</code> (overridable per suite)</td> </tr> </tbody> </table> <h4 id=822-bleeding-edge-randomized-order-as-default>8.2.2 Bleeding Edge: Randomized Order as DEFAULT<a class=headerlink href=#822-bleeding-edge-randomized-order-as-default title="Permanent link">&para;</a></h4> <p>Instead of always A/B → B/A test: <strong>randomized order (with seed) is DEFAULT</strong> in CI for pairwise comparisons.</p> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-core/src/judge/order.rs</code></td> <td><strong>New.</strong> <code>OrderStrategy::Randomized</code> (default) or <code>Fixed</code> for backward compat</td> </tr> <tr> <td>Config</td> <td><code>judge.order_strategy: "randomized"</code> (default)</td> </tr> <tr> <td>Output</td> <td><strong>Seed logged in summary.json én job summary</strong> (zodat reviewers direct zien) for replay</td> </tr> </tbody> </table> <p>This makes position bias visible without extra calls.</p> <h4 id=823-order-invariance-bias-mitigation>8.2.3 Order-Invariance (Bias Mitigation)<a class=headerlink href=#823-order-invariance-bias-mitigation title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-core/src/judge/reliability.rs</code></td> <td><strong>New.</strong> <code>OrderInvariantEval</code>: run both A/B and B/A for pairwise judgments; aggregate with majority/score-averaging</td> </tr> <tr> <td>Output metrics</td> <td><code>order_invariance_rate</code>, <code>flip_rate</code> (label changed over A/B vs B/A)</td> </tr> </tbody> </table> <h4 id=824-bleeding-edge-rerun-on-instability-not-just-borderline>8.2.4 Bleeding Edge: Rerun on Instability (Not Just Borderline)<a class=headerlink href=#824-bleeding-edge-rerun-on-instability-not-just-borderline title="Permanent link">&para;</a></h4> <p>Rerun triggers expanded beyond borderline:</p> <table> <thead> <tr> <th>Condition</th> <th>Trigger</th> <th>Config</th> </tr> </thead> <tbody> <tr> <td><strong>Borderline</strong></td> <td>score in [0.4, 0.6]</td> <td><code>judge.borderline_band</code></td> </tr> <tr> <td><strong>Low margin</strong></td> <td><code>|score − 0.5| &lt; ε</code></td> <td><code>judge.margin_threshold: 0.1</code></td> </tr> <tr> <td><strong>Order flip</strong></td> <td>A/B ≠ B/A verdict</td> <td>automatic</td> </tr> <tr> <td><strong>High variance</strong></td> <td>std_dev &gt; threshold</td> <td><code>judge.variance_threshold</code></td> </tr> <tr> <td><strong>Judge unavailable</strong></td> <td>timeout/5xx</td> <td>fallback policy</td> </tr> </tbody> </table> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># Config example</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=nt>judge</span><span class=p>:</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>  </span><span class=nt>rerun_triggers</span><span class=p>:</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">borderline</span><span class=w>      </span><span class=c1># score in [0.4, 0.6]</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">low_margin</span><span class=w>      </span><span class=c1># |score - 0.5| &lt; margin_threshold</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">order_flip</span><span class=w>      </span><span class=c1># A/B vs B/A disagreement</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">high_variance</span><span class=w>   </span><span class=c1># std_dev &gt; variance_threshold</span>
</span></code></pre></div> <h4 id=825-rerun-strategy-2-of-3-majority>8.2.5 Rerun Strategy (2-of-3 Majority)<a class=headerlink href=#825-rerun-strategy-2-of-3-majority title="Permanent link">&para;</a></h4> <div class="language-text highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>if first_run NOT in rerun_triggers:
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    return verdict (done, 1 call)
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>elif first_run triggers rerun:
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>    run second
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>    if first == second:
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>        return verdict (done, 2 calls)
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>    else:
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>        run third
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>        return majority(first, second, third) (done, 3 calls)
</span></code></pre></div> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-core/src/judge/rerun.rs</code></td> <td><strong>New.</strong> <code>RerunStrategy::TwoOfThree</code> with instability triggers</td> </tr> <tr> <td>Config</td> <td><code>judge.rerun_strategy: "two_of_three"</code> (default) or <code>"always_three"</code></td> </tr> </tbody> </table> <h4 id=826-output-metrics>8.2.6 Output Metrics<a class=headerlink href=#826-output-metrics title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Metric</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>consensus_rate</code></td> <td>% runs where all iterations agreed</td> </tr> <tr> <td><code>flip_rate</code></td> <td>% runs where label changed over iterations</td> </tr> <tr> <td><code>abstain_rate</code></td> <td>% runs returning "uncertain"</td> </tr> <tr> <td><code>margin</code></td> <td>Average distance to decision boundary</td> </tr> <tr> <td><code>order_seed</code></td> <td>Seed used for randomized order (for replay)</td> </tr> <tr> <td><code>effective_sample_size</code></td> <td>For weighted voting (future)</td> </tr> </tbody> </table> <h4 id=827-bleeding-edge-config-first-policies-per-suite-type>8.2.7 Bleeding Edge: Config-First Policies per Suite Type<a class=headerlink href=#827-bleeding-edge-config-first-policies-per-suite-type title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Suite Type</th> <th>Uncertain Policy</th> <th>Rationale</th> </tr> </thead> <tbody> <tr> <td><strong>security</strong></td> <td><code>fail_closed</code></td> <td>uncertain = fail (security posture)</td> </tr> <tr> <td><strong>quality</strong></td> <td><code>quarantine</code></td> <td>warn, optional human review</td> </tr> <tr> <td><strong>regression</strong></td> <td><code>fail_on_confident</code></td> <td>fail only on confident regression, quarantine uncertain</td> </tr> </tbody> </table> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># Config example</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=nt>suites</span><span class=p>:</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">security_checks</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>    </span><span class=nt>uncertain_policy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">fail_closed</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">quality_metrics</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">quality</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>    </span><span class=nt>uncertain_policy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">quarantine</span>
</span></code></pre></div> <h4 id=828-fail-modes-split-uncertain-from-unavailable>8.2.8 Fail Modes: Split "Uncertain" from "Unavailable"<a class=headerlink href=#828-fail-modes-split-uncertain-from-unavailable title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Condition</th> <th>Exit Code</th> <th>Reason Code</th> <th>Default Policy</th> </tr> </thead> <tbody> <tr> <td>Judge returns "uncertain" (instability detected)</td> <td>1</td> <td><code>E_JUDGE_UNCERTAIN</code></td> <td>Configurable per suite type</td> </tr> <tr> <td>Judge unavailable (timeout/5xx/rate limit)</td> <td>3</td> <td><code>E_JUDGE_UNAVAILABLE</code></td> <td>Fail-closed with clear reason</td> </tr> </tbody> </table> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-cli/src/exit_codes.rs</code></td> <td>Add <code>E_JUDGE_UNCERTAIN</code> reason code</td> </tr> <tr> <td><code>crates/assay-core/src/judge/policy.rs</code></td> <td><code>JudgeFailPolicy::FailClosed</code>, <code>JudgeFailPolicy::Quarantine</code> per suite type</td> </tr> </tbody> </table> <h4 id=829-future-multi-judge-support-placeholder>8.2.9 Future: Multi-Judge Support (Placeholder)<a class=headerlink href=#829-future-multi-judge-support-placeholder title="Permanent link">&para;</a></h4> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># Structure for later: 2 different judge models (cheap + strong)</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=nt>judge</span><span class=p>:</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>  </span><span class=nt>models</span><span class=p>:</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">fast</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>      </span><span class=nt>model</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">gpt-4o-mini</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>      </span><span class=nt>role</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">first_pass</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">strong</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>      </span><span class=nt>model</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">gpt-4o</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=w>      </span><span class=nt>role</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tiebreaker</span><span class=w>  </span><span class=c1># only on disagreement</span>
</span></code></pre></div> <h4 id=8210-definition-of-done>8.2.10 Definition of Done<a class=headerlink href=#8210-definition-of-done title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> <strong>Randomized order default</strong> with seed in summary.json + job summary</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> <strong>Cost guardrails:</strong> <code>judge.max_extra_calls_per_run</code> (default 2); warning logged when cap reached</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> <strong>Rerun-on-instability</strong> (borderline + low_margin + order_flip + high_variance)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Config-first policies per suite type (security/quality/regression)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> CI-run produces <code>consensus_rate</code>, <code>flip_rate</code>, <code>abstain_rate</code>, <code>margin</code></li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Reason codes <code>E_JUDGE_UNCERTAIN</code>, <code>E_JUDGE_UNAVAILABLE</code></li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Multi-judge config placeholder (structure, not full implementation)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> <strong>Audit E:</strong> Robust JSON Parsing (Greedy stream seeker)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> <strong>Audit F:</strong> Audit Evidence Pack (E7-AUDIT.md)</li> </ul> <p><strong>Effort:</strong> 2–3 days (MVP), +1 day for tuning PRs</p> <p><strong>DX Impact:</strong> Fewer flaky failures → devs trust CI again. "Uncertain" with reason_code + next_step → faster debugging.</p> <hr> <h3 id=83-p12-otel-genai-observability>8.3 P1.2 OTel GenAI (Observability)<a class=headerlink href=#83-p12-otel-genai-observability title="Permanent link">&para;</a></h3> <p><strong>Goal:</strong> OpenTelemetry GenAI semantic conventions compliance; privacy-safe defaults.</p> <h4 id=831-bleeding-edge-semconv-version-gating>8.3.1 Bleeding Edge: Semconv Version Gating<a class=headerlink href=#831-bleeding-edge-semconv-version-gating title="Permanent link">&para;</a></h4> <p><strong>Critical:</strong> GenAI semconv evolves rapidly. Without version gating, backward compat breaks.</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># Config</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=nt>otel</span><span class=p>:</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>  </span><span class=nt>genai_semconv_version</span><span class=p>:</span><span class=w> </span><span class=s>&quot;1.28.0&quot;</span><span class=w>  </span><span class=c1># or &quot;latest&quot;</span>
</span></code></pre></div> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-core/src/otel/genai.rs</code></td> <td>Version-gated span attributes</td> </tr> <tr> <td><code>summary.json</code> / bundle manifest</td> <td>Include which semconv mapping was used</td> </tr> <tr> <td>Feature flag</td> <td><code>--features otel-genai-semconv-1.28</code></td> </tr> </tbody> </table> <h4 id=832-span-layers>8.3.2 Span Layers<a class=headerlink href=#832-span-layers title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Span Type</th> <th>Attributes (GenAI semconv)</th> </tr> </thead> <tbody> <tr> <td><strong>Provider span</strong> (HTTP)</td> <td><code>http.method</code>, <code>http.url</code>, <code>http.status_code</code>, <code>http.request.duration</code></td> </tr> <tr> <td><strong>GenAI logical span</strong></td> <td><code>gen_ai.system</code>, <code>gen_ai.request.model</code>, <code>gen_ai.usage.input_tokens</code>, <code>gen_ai.usage.output_tokens</code>, <code>gen_ai.response.finish_reasons</code>, <code>assay.cache_hit</code></td> </tr> </tbody> </table> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-core/src/providers/trace.rs</code></td> <td>Extend with GenAI semconv attributes</td> </tr> <tr> <td><code>crates/assay-core/src/otel/genai.rs</code></td> <td><strong>New.</strong> GenAI span builder conforming to OTel semantic conventions (versioned)</td> </tr> </tbody> </table> <h4 id=833-bleeding-edge-low-cardinality-enforcement-hard>8.3.3 Bleeding Edge: Low-Cardinality Enforcement (Hard)<a class=headerlink href=#833-bleeding-edge-low-cardinality-enforcement-hard title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Allowed Labels</th> <th>Forbidden Labels</th> </tr> </thead> <tbody> <tr> <td><code>provider</code>, <code>model</code>, <code>operation</code>, <code>outcome</code></td> <td>prompt hash, user id, request id, trace id</td> </tr> <tr> <td><code>verdict</code>, <code>suite_type</code></td> <td>file paths, dynamic strings</td> </tr> </tbody> </table> <table> <thead> <tr> <th>Metric</th> <th>Labels</th> </tr> </thead> <tbody> <tr> <td><code>assay.llm.request.duration</code></td> <td><code>provider</code>, <code>model</code>, <code>operation</code> (chat/embeddings/judge), <code>outcome</code> (ok/error/uncertain/cache_hit)</td> </tr> <tr> <td><code>assay.llm.tokens.total</code></td> <td><code>provider</code>, <code>model</code>, <code>direction</code> (input/output)</td> </tr> <tr> <td><code>assay.judge.decisions</code></td> <td><code>verdict</code> (pass/fail/uncertain), <code>suite_type</code> (security/quality)</td> </tr> </tbody> </table> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-core/src/otel/metrics.rs</code></td> <td><strong>New.</strong> Metrics registry with above definitions</td> </tr> <tr> <td>Tests</td> <td><strong>New.</strong> <code>test_metric_labels_bounded()</code> (cardinality budget); <strong>"reject dynamic labels" guard</strong> in code (geen prompt hash, user id, trace id, file paths als labels)</td> </tr> </tbody> </table> <h4 id=834-bleeding-edge-composable-redaction-policies>8.3.4 Bleeding Edge: Composable Redaction Policies<a class=headerlink href=#834-bleeding-edge-composable-redaction-policies title="Permanent link">&para;</a></h4> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=nt>otel</span><span class=p>:</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>  </span><span class=nt>capture_prompts</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w>  </span><span class=c1># default</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>  </span><span class=nt>redaction_policies</span><span class=p>:</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">strip_secrets</span><span class=w>      </span><span class=c1># API keys, tokens</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">strip_file_paths</span><span class=w>   </span><span class=c1># Local paths</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">strip_pii</span><span class=w>          </span><span class=c1># Email, phone (regex)</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>custom</span><span class=p>:</span><span class=w> </span><span class=s>&quot;s/password=.*/password=REDACTED/&quot;</span>
</span></code></pre></div> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td>Config</td> <td><code>otel.capture_prompts: false</code> (default), <code>otel.redaction_policies: [...]</code></td> </tr> <tr> <td><code>crates/assay-core/src/otel/redaction.rs</code></td> <td><strong>New.</strong> Composable redaction policies</td> </tr> <tr> <td>Tests</td> <td>Golden tests: default = no prompt in export; <code>capture_prompts: true</code> = redacted content</td> </tr> </tbody> </table> <h4 id=835-definition-of-done>8.3.5 Definition of Done<a class=headerlink href=#835-definition-of-done title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Semconv version gating</strong> in config + manifest</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Low-cardinality enforcement tests</strong> (labels bounded)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Spans conform GenAI semconv (versioned)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Composable redaction policies</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Golden tests: default = no prompt; full = redacted content</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Config documented in <code>docs/reference/config/observability.md</code></li> </ul> <p><strong>Effort:</strong> 1–2 days</p> <p><strong>DX Impact:</strong> "Why is this slow/flaky" → spans/metrics immediately available.</p> <hr> <h3 id=84-replay-bundle-dx-forensic>8.4 Replay Bundle (DX + Forensic)<a class=headerlink href=#84-replay-bundle-dx-forensic title="Permanent link">&para;</a></h3> <p><strong>Goal:</strong> Reproducible test runs from a single artifact; supply-chain aware.</p> <h4 id=841-bundle-format>8.4.1 Bundle Format<a class=headerlink href=#841-bundle-format title="Permanent link">&para;</a></h4> <div class="language-text highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>.assay/replay.bundle/
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>├── manifest.json          # Provenance + file digests + toolchain
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>├── config/
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>│   ├── eval.yaml
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>│   └── policy.yaml
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>├── traces/
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>│   └── input.jsonl
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>├── cassettes/             # VCR recordings (scrubbed)
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>│   └── openai/
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>│       └── *.json
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>├── baseline/
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>│   └── baseline.json
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>└── toolchain/             # NEW: for true reproducibility
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>    ├── Cargo.lock
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a>    └── cargo-metadata.json
</span></code></pre></div> <h4 id=842-bleeding-edge-toolchain-capture-critical-for-reproducibility>8.4.2 Bleeding Edge: Toolchain Capture (Critical for Reproducibility)<a class=headerlink href=#842-bleeding-edge-toolchain-capture-critical-for-reproducibility title="Permanent link">&para;</a></h4> <p>Without toolchain capture, "replay works on my machine" is common. Include:</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=p>{</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>  </span><span class=nt>&quot;schema_version&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>  </span><span class=nt>&quot;created_at&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2026-01-30T12:00:00Z&quot;</span><span class=p>,</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>  </span><span class=nt>&quot;assay_version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2.12.0&quot;</span><span class=p>,</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=w>  </span><span class=nt>&quot;git_sha&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;abc123...&quot;</span><span class=p>,</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>  </span><span class=nt>&quot;workflow_run_id&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;12345678&quot;</span><span class=p>,</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=w>  </span><span class=nt>&quot;toolchain&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=w>    </span><span class=nt>&quot;rustc&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;rustc 1.84.0 (9fc6b4312 2025-01-07)&quot;</span><span class=p>,</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=w>    </span><span class=nt>&quot;cargo&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;cargo 1.84.0 (66221abde 2024-11-19)&quot;</span><span class=p>,</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=w>    </span><span class=nt>&quot;target_triple&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;aarch64-apple-darwin&quot;</span><span class=p>,</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=w>    </span><span class=nt>&quot;cargo_lock_digest&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sha256:abc123...&quot;</span><span class=p>,</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=w>    </span><span class=nt>&quot;cargo_metadata_snapshot&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sha256:def456...&quot;</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=w>  </span><span class=p>},</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=w>  </span><span class=nt>&quot;runner&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=w>    </span><span class=nt>&quot;os&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Linux&quot;</span><span class=p>,</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=w>    </span><span class=nt>&quot;os_version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Ubuntu 22.04.3 LTS&quot;</span><span class=p>,</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=w>    </span><span class=nt>&quot;runner_image&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ubuntu-latest&quot;</span><span class=p>,</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=w>    </span><span class=nt>&quot;uname&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Linux 6.5.0-1025-azure x86_64&quot;</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=w>  </span><span class=p>},</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=w>  </span><span class=nt>&quot;files&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=w>    </span><span class=nt>&quot;config/eval.yaml&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;sha256&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;...&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;size_bytes&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1234</span><span class=w> </span><span class=p>},</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=w>    </span><span class=nt>&quot;traces/input.jsonl&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nt>&quot;sha256&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;...&quot;</span><span class=p>,</span><span class=w> </span><span class=nt>&quot;size_bytes&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>5678</span><span class=w> </span><span class=p>}</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=w>  </span><span class=p>},</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=w>  </span><span class=nt>&quot;bundle_digest&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sha256:...&quot;</span><span class=p>,</span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a><span class=w>  </span><span class=nt>&quot;tool_versions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a><span class=w>    </span><span class=nt>&quot;openai_sdk&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1.x.x&quot;</span><span class=p>,</span>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a><span class=w>    </span><span class=nt>&quot;reqwest&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;0.12.x&quot;</span>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a><span class=p>}</span>
</span></code></pre></div> <p><strong>Captured files:</strong> - <code>Cargo.lock</code> (exact dependency versions) - <code>cargo metadata --format-version 1</code> snapshot - <code>rustc -Vv</code> output - Runner environment metadata</p> <h4 id=843-bleeding-edge-deterministic-seed-logging>8.4.3 Bleeding Edge: Deterministic Seed Logging<a class=headerlink href=#843-bleeding-edge-deterministic-seed-logging title="Permanent link">&para;</a></h4> <p>For judge reliability: seed is logged → replay with same seed = same order.</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=p>{</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=w>  </span><span class=nt>&quot;determinism&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=w>    </span><span class=nt>&quot;judge_order_seed&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>42</span><span class=p>,</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=w>    </span><span class=nt>&quot;random_seed&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>12345</span><span class=p>,</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=w>    </span><span class=nt>&quot;timestamp_frozen&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=p>}</span>
</span></code></pre></div> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-core/src/replay/bundle.rs</code></td> <td><strong>New.</strong> Bundle creation + manifest generation</td> </tr> <tr> <td><code>crates/assay-core/src/replay/manifest.rs</code></td> <td><strong>New.</strong> Manifest schema + digest computation + toolchain capture</td> </tr> <tr> <td><code>crates/assay-cli/src/cli/commands/replay.rs</code></td> <td><strong>New.</strong> <code>assay replay --bundle &lt;path&gt;</code> command</td> </tr> </tbody> </table> <h4 id=844-bleeding-edge-scrubbed-cassettes-policy>8.4.4 Bleeding Edge: Scrubbed Cassettes Policy<a class=headerlink href=#844-bleeding-edge-scrubbed-cassettes-policy title="Permanent link">&para;</a></h4> <p><strong>SOTA:</strong> Scrubbing <strong>deny-by-default</strong> (allowlist van toegestane velden, niet blocklist). Zo blijft bundle veilig bij nieuwe velden.</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=nt>replay</span><span class=p>:</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>  </span><span class=nt>include_prompts</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w>        </span><span class=c1># default</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=w>  </span><span class=nt>scrub_cassettes</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class=w>         </span><span class=c1># remove secrets from VCR cassettes</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=w>  </span><span class=nt>scrub_policy</span><span class=p>:</span><span class=w> </span><span class=s>&quot;default&quot;</span><span class=w>       </span><span class=c1># allowlist (niet blocklist)</span>
</span></code></pre></div> <table> <thead> <tr> <th>File</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-core/src/replay/scrub.rs</code></td> <td><strong>New.</strong> Cassette scrubbing: <strong>deny-by-default</strong> (allowlist); geen magische blocklist.</td> </tr> <tr> <td>Tests</td> <td>Bundle is safe to share (no secrets, no PII).</td> </tr> </tbody> </table> <h4 id=845-privacy-minimal-secrets-risk>8.4.5 Privacy: Minimal Secrets Risk<a class=headerlink href=#845-privacy-minimal-secrets-risk title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Default</th> <th>Behavior</th> </tr> </thead> <tbody> <tr> <td><code>replay.include_prompts: false</code></td> <td>No prompt/response content in bundle unless explicit</td> </tr> <tr> <td><code>replay.include_cassettes: true</code></td> <td>VCR cassettes included (scrubbed)</td> </tr> <tr> <td><code>replay.scrub_cassettes: true</code></td> <td>Remove API keys, tokens, PII from cassettes</td> </tr> </tbody> </table> <h4 id=846-cli-interface>8.4.6 CLI Interface<a class=headerlink href=#846-cli-interface title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># Create bundle from last run</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>assay<span class=w> </span>bundle<span class=w> </span>create<span class=w> </span>--output<span class=w> </span>replay.bundle
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=c1># Replay bundle (offline, VCR mode)</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>assay<span class=w> </span>replay<span class=w> </span>--bundle<span class=w> </span>replay.bundle
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=c1># Replay with network (re-run against live providers)</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>assay<span class=w> </span>replay<span class=w> </span>--bundle<span class=w> </span>replay.bundle<span class=w> </span>--live
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=c1># Replay with specific seed (for judge order reproducibility)</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>assay<span class=w> </span>replay<span class=w> </span>--bundle<span class=w> </span>replay.bundle<span class=w> </span>--seed<span class=w> </span><span class=m>42</span>
</span></code></pre></div> <h4 id=847-definition-of-done>8.4.7 Definition of Done<a class=headerlink href=#847-definition-of-done title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Toolchain capture</strong> (rustc, cargo, lock, metadata, runner)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Deterministic seed logging</strong> for reproducibility</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Manifest with file digests + provenance</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <code>assay replay --bundle</code> reproduces (VCR, deterministic seeds)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Scrubbed cassettes policy + tests</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Privacy: no prompts/secrets unless opt-in</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Signature placeholder (structure for later Sigstore/cosign)</li> </ul> <p><strong>Effort:</strong> 2–3 days</p> <p><strong>DX Impact:</strong> Reviewers can reproduce "exactly this" locally. Bundle is often the "next step" on failures.</p> <hr> <h3 id=85-p1-file-level-checklist-updated>8.5 P1 File-Level Checklist (Updated)<a class=headerlink href=#85-p1-file-level-checklist-updated title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>File / Area</th> <th>P1.3 MCP</th> <th>P1.1 Judge</th> <th>P1.2 OTel</th> <th>Replay</th> </tr> </thead> <tbody> <tr> <td><code>crates/assay-mcp-server/src/auth/</code></td> <td>Resource + BCP + <strong>alg/typ/crit</strong></td> <td>—</td> <td>—</td> <td>—</td> </tr> <tr> <td><code>crates/assay-mcp-server/src/auth/jwks.rs</code></td> <td>JWKS rotation + cache + <strong>stale-while-revalidate</strong></td> <td>—</td> <td>—</td> <td>—</td> </tr> <tr> <td><code>crates/assay-mcp-server/src/auth/dpop.rs</code></td> <td>DPoP + <strong>jti cache</strong></td> <td>—</td> <td>—</td> <td>—</td> </tr> <tr> <td><code>crates/assay-core/src/judge/borderline.rs</code></td> <td>—</td> <td>Borderline band</td> <td>—</td> <td>—</td> </tr> <tr> <td><code>crates/assay-core/src/judge/order.rs</code></td> <td>—</td> <td><strong>Randomized order</strong> (NEW)</td> <td>—</td> <td>—</td> </tr> <tr> <td><code>crates/assay-core/src/judge/reliability.rs</code></td> <td>—</td> <td>Order-invariance</td> <td>—</td> <td>—</td> </tr> <tr> <td><code>crates/assay-core/src/judge/rerun.rs</code></td> <td>—</td> <td>2-of-3 + <strong>instability triggers</strong></td> <td>—</td> <td>—</td> </tr> <tr> <td><code>crates/assay-core/src/judge/policy.rs</code></td> <td>—</td> <td>Fail policies <strong>per suite type</strong></td> <td>—</td> <td>—</td> </tr> <tr> <td><code>crates/assay-core/src/otel/genai.rs</code></td> <td>—</td> <td>—</td> <td>GenAI spans + <strong>semconv version</strong></td> <td>—</td> </tr> <tr> <td><code>crates/assay-core/src/otel/metrics.rs</code></td> <td>—</td> <td>—</td> <td>LLM metrics + <strong>cardinality tests</strong></td> <td>—</td> </tr> <tr> <td><code>crates/assay-core/src/otel/redaction.rs</code></td> <td>—</td> <td>—</td> <td><strong>Composable</strong> redaction</td> <td>—</td> </tr> <tr> <td><code>crates/assay-core/src/replay/bundle.rs</code></td> <td>—</td> <td>—</td> <td>—</td> <td>Bundle create</td> </tr> <tr> <td><code>crates/assay-core/src/replay/manifest.rs</code></td> <td>—</td> <td>—</td> <td>—</td> <td>Manifest + <strong>toolchain</strong></td> </tr> <tr> <td><code>crates/assay-core/src/replay/scrub.rs</code></td> <td>—</td> <td>—</td> <td>—</td> <td><strong>Cassette scrubbing</strong> (NEW)</td> </tr> <tr> <td><code>crates/assay-cli/src/cli/commands/replay.rs</code></td> <td>—</td> <td>—</td> <td>—</td> <td>CLI</td> </tr> <tr> <td><code>crates/assay-cli/src/exit_codes.rs</code></td> <td>—</td> <td>E_JUDGE_UNCERTAIN</td> <td>—</td> <td>—</td> </tr> <tr> <td>Tests (negative)</td> <td>alg/typ/crit, JWKS, passthrough, <strong>jti cache</strong></td> <td>order-invariance, consensus, <strong>instability</strong></td> <td>redaction goldens, <strong>cardinality</strong></td> <td>bundle roundtrip, <strong>scrubbed</strong></td> </tr> </tbody> </table> <hr> <h3 id=86-p1-effort-summary>8.6 P1 Effort Summary<a class=headerlink href=#86-p1-effort-summary title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Epic</th> <th>Effort</th> <th>Dependencies</th> </tr> </thead> <tbody> <tr> <td>P1.3 MCP Auth Hardening</td> <td>2–3 days</td> <td>None (security baseline)</td> </tr> <tr> <td>P1.1 Judge Reliability MVP</td> <td>2–3 days (+1 tuning)</td> <td>P1.3 done</td> </tr> <tr> <td>P1.2 OTel GenAI</td> <td>1–2 days</td> <td>P1.1 helps with tuning</td> </tr> <tr> <td>Replay Bundle</td> <td>2–3 days</td> <td>All above (uses their outputs)</td> </tr> <tr> <td><strong>Total</strong></td> <td><strong>8–12 days</strong></td> <td>Sequential with parallelization possible</td> </tr> </tbody> </table> <p><strong>DX-items priority:</strong> <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/10 title="GitHub Issue: Rul1an/assay #10">#10</a> (next steps) → <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/11 title="GitHub Issue: Rul1an/assay #11">#11</a> (perf DX) → <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/Rul1an/assay/issues/13 title="GitHub Issue: Rul1an/assay #13">#13</a> (privacy) — highest impact first.</p> <hr> <h3 id=87-pr-sequence-blueprint>8.7 PR Sequence Blueprint<a class=headerlink href=#87-pr-sequence-blueprint title="Permanent link">&para;</a></h3> <p>Recommended PR structure for implementation:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>PR 1: P1.3 MCP Auth Hardening
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>  ├── auth/resource.rs (RFC 8707)
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>  ├── auth/jwt_validation.rs (alg/typ/crit)
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>  ├── auth/jwks.rs (cache improvements)
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>  ├── auth/dpop.rs (optional, behind feature flag)
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>  └── tests/auth_negative.rs
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>PR 2: P1.1 Judge Reliability
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>  ├── judge/borderline.rs
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>  ├── judge/order.rs (randomized default)
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>  ├── judge/rerun.rs (instability triggers)
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>  ├── judge/policy.rs (suite-type policies)
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>  └── tests/judge_reliability.rs
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>PR 3: P1.2 OTel GenAI
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>  ├── otel/genai.rs (semconv versioned)
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>  ├── otel/metrics.rs (low-cardinality)
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>  ├── otel/redaction.rs (composable)
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>  └── tests/otel_cardinality.rs
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a>
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a>PR 4: Replay Bundle
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a>  ├── replay/bundle.rs
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a>  ├── replay/manifest.rs (toolchain, seeds)
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a>  ├── replay/scrub.rs
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a>  └── tests/bundle_roundtrip.rs
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a>
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a>DX Mini-PRs (parallel):
</span><span id=__span-11-28><a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a>  ├── #10: suggest_next_steps()
</span><span id=__span-11-29><a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a>  ├── #11: slowest 5 + phase timings
</span><span id=__span-11-30><a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a>  └── #13: privacy defaults + redaction tests
</span></code></pre></div> <hr> <h2 id=9-references>9. References<a class=headerlink href=#9-references title="Permanent link">&para;</a></h2> <ul> <li><strong>§0 Epics Overview</strong> — epics E1–E9 met stories, acceptance criteria en effort</li> <li><a href=DX-REVIEW-MATERIALS.md>DX-REVIEW-MATERIALS.md</a> — current DX review materials</li> <li><a href=architecture/ADR-019-PR-Gate-2026-SOTA.md>ADR-019 PR Gate 2026 SOTA</a> — performance, DX, security, judge, observability</li> <li><a href=ROADMAP.md>ROADMAP</a> — strategic roadmap</li> <li><a href=reference/cli/run.md>reference/cli/run.md</a> — run exit codes and outputs</li> <li><a href=guides/troubleshooting.md>guides/troubleshooting.md</a> — troubleshooting guide</li> </ul> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 Assay </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/Rul1an/assay target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/assay_dev target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://discord.gg/assay target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg> </a> <a href=https://getassay.dev target=_blank rel=noopener title=getassay.dev class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.top", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "content.tabs.link", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.fe8b6f2b.min.js></script> </body> </html>