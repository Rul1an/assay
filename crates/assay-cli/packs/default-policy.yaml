version: "1.0"
name: "mcp-default-gate"

# Opinionated Defaults: top 3 attack vectors blocked by default.
allow:
  # Allow standard MCP tools by default, but block dangerous capabilities
  - "*"

deny:
  # 1. No Shell / Exec capabilities (RCE Prevention)
  - "exec"
  - "shell"
  - "bash"
  - "cmd"
  - "powershell"
  - "spawn"
  - "python_sandbox" # Unless explicitly authorized

  # 2. Blocking sensitive filesystem ops implies manual review for standard "filesystem" server
  # (Assumes standard "filesystem" tool names, adjust if yours differ)
  # - "write_file"
  # - "delete_file"

constraints:
  # 3. Excessive permissions audit
  # Force stricter review on 'fs' tools if they exist
  - tool: "read_file"
    params:
      path:
        matches: "^/app/.*|^/data/.*" # Container-safe paths only

signatures:
  # 4. Tool Poisoning Heuristics check (handled by Assay runtime)
  check_descriptions: true
